!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="https://cytroncdn.videojj.com/release/6.4.2/",t(0)}([function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(44),d=o(f),p=n(6),h=o(p),y=n(82),v=r(y),m=n(77),g=n(96),b=n(188),_=o(b),w=n(189),O=o(w),T=n(173),k=r(T),I=n(102),E=n(43),S=o(E),x=n(174),M=o(x),C=n(103),P=o(C),j=n(196),N=o(j),A=n(97);(0,d["default"])("cytron-platform");var R=0,D=n(5)("cy:Cytron"),L=function(){function e(t,n){s(this,e),this.instanceId=++R,this.rootId=h["default"].name+"-"+this.instanceId,this.disabled=I.notSupport||n.disabled,this.mode=this.disabled?"":I.isMobile?"mobile":"normal";var r=(0,m.getElement)(t);(0,m.assert)(r,t+"容器未找到");var o=["appkey","video"],i=o.every(function(e){return!(0,m.isEmpty)(n[e])});(0,m.assert)(i,"缺少config必要字段，请确保您的config包含："+o.join(", ")),Object.defineProperty(this,"$container",{value:r}),Object.defineProperty(this,"config",{value:u({},n,{fps:h["default"].fps})}),!this.disabled&&(0,S["default"])(r),M["default"].setAppkey(n.appkey),M["default"].setDPI(r.getBoundingClientRect())}return l(e,[{key:"start",value:function(){var e=this;if(window["__CYTRON_"+this.instanceId+"__"]=this,this.hasStart())throw new Error("Cytron 已经启动了...");h["default"].debug&&(0,m.groupStartLog)("CYTRON_START"),D("=====> Starting Cytron...",this.rootId),P["default"].setup(this.config).then(function(){return P["default"].getVideoConfigs(e.config.video)}).then(function(t){v.assign(e.config,u({},t.config,e.config)),D("=====> Loading Cytron Player and VideoData...");var n=e.config.playerUrl||h["default"].publicUrl+"player.venvy.js",r=e.config.videoDataUrl||t.videoDataUrl;return g.Promise.all([(0,A.$load)("player",n,e.$container,e.config),"normal"===e.mode?P["default"].getVideoData(r):g.Promise.resolve({}),"normal"===e.mode?P["default"].getGlobalData():g.Promise.resolve({})])}).then(function(t){var n=c(t,3),r=n[0],o=n[1],i=n[2];D("=====> Cytron Player and VideoData Loaded..."),r.onReady(function(){D("=====> Player onReady"),e.startTheParty(r,o,i),P["default"].track({cat:h["default"].trackCategory.videoView})}),D("=====> Waiting for player onReady callback ...")})["catch"](function(e){console.error("=====> Cytron Error",e)})}},{key:"startTheParty",value:function(e,t,n){var r=this,o=t.flowMaps||[],i=t.flows||[],a=n.flowMaps||[],s=n.flows||[],c=o.concat(a),u=i.concat(s);if(this.flowManager=(0,_["default"])(c,u),this.runner=(0,O["default"])(this),this.session=M["default"],this.player=e,this.player.onPlay(this.runner.onPlay),this.player.onPause(this.runner.onPause),this.player.onStop(this.runner.onStop),this.player.onSetTime(this.runner.onSetTime),this.player.onFullscreen(this.runner.onFullscreen),this.player.onExitFullscreen(this.runner.onExitFullscreen),this.actions=this.runner.getStore().bindActions(k),!this.disabled){this.mqttClient=new N["default"]({parent:this.$container,clientId:M["default"].getClientId(),videoId:M["default"].getVideoId(),channelId:M["default"].getChannel(),projectId:M["default"].getProject(),onConnect:function(){P["default"].track({cat:h["default"].trackCategory.mqttConnect}),P["default"].mqttNotify()}});var l=function(e){var t=e.flowMaps,n=e.flows;r.runner.registerModules(t),r.runner.registerFlows(n,"LIVE_FLOW")},f=function(e){var t=e.flowId;r.runner.removeFlow(t,"LIVE_FLOW")};this.mqttClient.addMsgListener("showFlow",l),this.mqttClient.addMsgListener("hideFlow",f),this.runner.bootstrap(),this.runner.registerModules(c);var d=[],p=this.config.editorEnable!==!1&&"normal"===this.mode&&M["default"].getToken(),y=this.config.vorEnable!==!1&&"normal"===this.mode&&M["default"].getIdentity();p&&d.push("plugin.editor"),y&&d.push("plugin.vor"),"mobile"===this.mode&&d.push("plugin.h5"),this.runner.registerPlugins(d)}e.isPlaying()&&(D("=====> Runner Started ..."),this.runner.onPlay()),this.disabled?D("=====> Sorry, Cytron Not Support!",this):D("=====> Cytron Started!",this),h["default"].debug&&(0,m.groupEndLog)("CYTRON_START"),this.focusOrBlurTime=Date.now(),window.onfocus=function(){P["default"].track({cat:h["default"].trackCategory.videoFocus,dr:Date.now()-r.focusOrBlurTime}),r.focusOrBlurTime=Date.now()},window.onblur=function(){P["default"].track({cat:h["default"].trackCategory.videoBlur,dr:Date.now()-r.focusOrBlurTime}),r.focusOrBlurTime=Date.now()},window.onbeforeunload=function(){P["default"].track({cat:h["default"].trackCategory.videoClose})}}},{key:"destroy",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&delete window["__CYTRON_"+this.instanceId+"__"],this.$style&&(this.$style.parentElement&&this.$style.parentElement.removeChild(this.$style),this.$style=void 0),this.runner&&this.runner.destroy(),this.player&&this.player.destroy(),this.mqttClient&&this.mqttClient.disconnect(),this.runner=void 0,this.player=void 0,this.flowManager=void 0,this.mqttClient=void 0,window.onblur=void 0,window.onfocus=void 0,window.onbeforeunload=void 0}},{key:"hasStart",value:function(){return Boolean(this.runner)}}]),e}();window.Cytron=L;var U=function(e){function t(e,n){s(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.start(),r}return a(t,e),t}(L);if(window.Iva=U,window.__CYTRON_INITED__){var B=window.__CYTRON_INITED__,F=B.parent,q=B.config;delete window.__CYTRON_INITED__,new U(F,q)}},function(e,t){"use strict";e.exports=window.__CYTRON_LIB__.preact},function(e,t){"use strict";e.exports=window.__CYTRON_LIB__.csjs},function(e,t){"use strict";e.exports=window.__CYTRON_LIB__.jsxKit},function(e,t,n){!function(e,n){n(t)}(this,function(e){function t(e,t,n){this.nodeName=e,this.attributes=t,this.children=n,this.key=t&&t.key}function n(e,t){if(t)for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}function r(e){return n({},e)}function o(e,t){for(var n=t.split("."),r=0;r<n.length&&e;r++)e=e[n[r]];return e}function i(e,t){return[].slice.call(e,t)}function a(e){return"function"==typeof e}function s(e){return"string"==typeof e}function c(e){return void 0===e||null===e}function u(e){return e===!1||c(e)}function l(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}function f(e,n,r){var o,i,c,d=arguments.length;if(d>2){var p=typeof r;if(3===d&&"object"!==p&&"function"!==p)u(r)||(o=[String(r)]);else{o=[];for(var h=2;h<d;h++){var y=arguments[h];if(!u(y)){y.join?i=y:(i=J)[0]=y;for(var v=0;v<i.length;v++){var m=i[v],g=!(u(m)||a(m)||m instanceof t);g&&!s(m)&&(m=String(m)),g&&c?o[o.length-1]+=m:u(m)||(o.push(m),c=g)}}}}}else if(n&&n.children)return f(e,n,n.children);n&&(n.children&&delete n.children,a(e)||("className"in n&&(n["class"]=n.className,delete n.className),c=n["class"],c&&!s(c)&&(n["class"]=l(c))));var b=new t(e,n||void 0,o);return G.vnode&&G.vnode(b),b}function d(e,t){return f(e.nodeName,n(r(e.attributes),t),arguments.length>2?i(arguments,2):e.children)}function p(e,t,n){var r=t.split("."),i=r[0];return function(t){var a,c,u,l=t&&t.currentTarget||this,f=e.state,d=f;if(c=s(n)?o(t,n):l.nodeName?(l.nodeName+l.type).match(/^input(check|rad)/i)?l.checked:l.value:t,r.length>1){for(u=0;u<r.length-1;u++)d=d[r[u]]||(d[r[u]]={});d[r[u]]=c,c=f[i]}e.setState((a={},a[i]=c,a))}}function h(e){1===re.push(e)&&(G.debounceRendering||X)(y)}function y(){if(re.length){var e,t=re;for(re=oe,oe=t;e=t.pop();)e._dirty&&V(e)}}function v(e){var t=e&&e.nodeName;return t&&a(t)&&!(t.prototype&&t.prototype.render)}function m(e,t){return e.nodeName(S(e),t||Z)}function g(e,t){return e[ee]||(e[ee]=t||{})}function b(e){return e instanceof Text?3:e instanceof Element?1:0}function _(e){var t=e.parentNode;t&&t.removeChild(e)}function w(e,t,n,r,o){if(g(e)[t]=n,"key"!==t&&"children"!==t&&"innerHTML"!==t)if("class"!==t||o)if("style"===t){if((!n||s(n)||s(r))&&(e.style.cssText=n||""),n&&"object"==typeof n){if(!s(r))for(var i in r)i in n||(e.style[i]="");for(var i in n)e.style[i]="number"!=typeof n[i]||te[i]?n[i]:n[i]+"px"}}else if("dangerouslySetInnerHTML"===t)n&&(e.innerHTML=n.__html);else if("o"==t[0]&&"n"==t[1]){var l=e._listeners||(e._listeners={});t=$(t.substring(2)),n?l[t]||e.addEventListener(t,T,!!ne[t]):l[t]&&e.removeEventListener(t,T,!!ne[t]),l[t]=n}else if("type"!==t&&!o&&t in e)O(e,t,c(n)?"":n),u(n)&&e.removeAttribute(t);else{var f=o&&t.match(/^xlink\:?(.+)/);u(n)?f?e.removeAttributeNS("http://www.w3.org/1999/xlink",$(f[1])):e.removeAttribute(t):"object"==typeof n||a(n)||(f?e.setAttributeNS("http://www.w3.org/1999/xlink",$(f[1]),n):e.setAttribute(t,n))}else e.className=n||""}function O(e,t,n){try{e[t]=n}catch(r){}}function T(e){return this._listeners[e.type](G.event&&G.event(e)||e)}function k(e){for(var t={},n=e.attributes.length;n--;)t[e.attributes[n].name]=e.attributes[n].value;return t}function I(e,t){return s(t)?3===b(e):s(t.nodeName)?E(e,t.nodeName):a(t.nodeName)?e._componentConstructor===t.nodeName||v(t):void 0}function E(e,t){return e.normalizedNodeName===t||$(e.nodeName)===$(t)}function S(e){var t=e.nodeName.defaultProps,o=r(t||e.attributes);return t&&n(o,e.attributes),e.children&&(o.children=e.children),o}function x(e){if(_(e),1===b(e)){C(e);var t=$(e.nodeName),n=ie[t];n?n.push(e):ie[t]=[e]}}function M(e,t){var n=$(e),r=ie[n]&&ie[n].pop()||(t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e));return g(r),r.normalizedNodeName=n,r}function C(e){g(e,k(e)),e._component=e._componentConstructor=null}function P(){for(var e;e=ae.pop();)e.componentDidMount&&e.componentDidMount()}function j(e,t,n,r,o,i){se++;var a=N(e,t,n,r,i);return o&&a.parentNode!==o&&o.appendChild(a),--se||P(),a}function N(e,t,n,r,o){for(var i=t&&t.attributes;v(t);)t=m(t,n);if(c(t)&&(t="",o)){if(e){if(8===e.nodeType)return e;D(e)}return document.createComment(t)}if(s(t)){if(e){if(3===b(e)&&e.parentNode)return e.nodeValue=t,e;D(e)}return document.createTextNode(t)}var u=e,l=t.nodeName,f=ce;if(a(l))return Y(e,t,n,r);if(s(l)||(l=String(l)),ce="svg"===l||"foreignObject"!==l&&ce,e){if(!E(e,l)){for(u=M(l,ce);e.firstChild;)u.appendChild(e.firstChild);D(e)}}else u=M(l,ce);return t.children&&1===t.children.length&&"string"==typeof t.children[0]&&1===u.childNodes.length&&u.firstChild instanceof Text?u.firstChild.nodeValue=t.children[0]:(t.children||u.firstChild)&&A(u,t.children,n,r),L(u,t.attributes),i&&i.ref&&(u[ee].ref=i.ref)(u),ce=f,u}function A(e,t,n,r){var o,i,s,u,l=e.childNodes,f=[],d={},p=0,h=0,y=l.length,v=0,m=t&&t.length;if(y)for(var g=0;g<y;g++){var b=l[g],_=m?(i=b._component)?i.__key:(i=b[ee])?i.key:null:null;_||0===_?(p++,d[_]=b):f[v++]=b}if(m)for(var g=0;g<m;g++){s=t[g],u=null;var _=s.key;if(c(_)){if(!u&&h<v){for(o=h;o<v;o++)if(i=f[o],i&&I(i,s)){u=i,f[o]=void 0,o===v-1&&v--,o===h&&h++;break}!u&&h<v&&a(s.nodeName)&&r&&(u=f[h],f[h++]=void 0)}}else p&&_ in d&&(u=d[_],d[_]=void 0,p--);u=N(u,s,n,r),u!==l[g]&&e.insertBefore(u,l[g]||null)}if(p)for(var g in d)d[g]&&(f[h=v++]=d[g]);h<v&&R(f)}function R(e,t){for(var n=e.length;n--;){var r=e[n];r&&D(r,t)}}function D(e,t){var n=e._component;n?H(n,!t):(e[ee]&&e[ee].ref&&e[ee].ref(null),t||x(e),e.childNodes&&e.childNodes.length&&R(e.childNodes,t))}function L(e,t){var n=e[ee]||k(e);for(var r in n)t&&r in t||w(e,r,null,n[r],ce);if(t)for(var o in t)o in n&&t[o]==n[o]&&("value"!==o&&"checked"!==o||t[o]==e[o])||w(e,o,t[o],n[o],ce)}function U(e){var t=e.constructor.name,n=ue[t];n?n.push(e):ue[t]=[e]}function B(e,t,n){var r=new e(t,n),o=ue[e.name];if(r.props=t,r.context=n,o)for(var i=o.length;i--;)if(o[i].constructor===e){r.nextBase=o[i].nextBase,o.splice(i,1);break}return r}function F(e){e._dirty||(e._dirty=!0,h(e))}function q(e,t,n,r,o){var i=e.base;e._disableRendering||(e._disableRendering=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,c(i)||o?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disableRendering=!1,0!==n&&(1!==n&&G.syncComponentUpdates===!1&&i?F(e):V(e,1,o)),e.__ref&&e.__ref(e))}function V(e,t,o){if(!e._disableRendering){var i,s,c=e.props,u=e.state,l=e.context,f=e.prevProps||c,d=e.prevState||u,p=e.prevContext||l,h=e.base,y=h||e.nextBase,g=e._component;if(h&&(e.props=f,e.state=d,e.context=p,2!==t&&e.shouldComponentUpdate&&e.shouldComponentUpdate(c,u,l)===!1?i=!0:e.componentWillUpdate&&e.componentWillUpdate(c,u,l),e.props=c,e.state=u,e.context=l),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!i){for(e.render&&(s=e.render(c,u,l)),e.getChildContext&&(l=n(r(l),e.getChildContext()));v(s);)s=m(s,l);var b,_,w=s&&s.nodeName;if(a(w)&&w.prototype.render){var O=g,T=S(s);O&&O.constructor===w?q(O,T,1,l):(b=O,O=B(w,T,l),O.nextBase=O.nextBase||o&&y,O._parentComponent=e,e._component=O,q(O,T,0,l),V(O,1)),_=O.base}else{var k=y;b=g,b&&(k=e._component=null),(y||1===t)&&(k&&(k._component=null),_=j(k,s,l,o||!h,y&&y.parentNode,!0))}if(y&&_!==y){var I=y.parentNode;I&&_!==I&&I.replaceChild(_,y),!b&&e._parentComponent&&(y._component=null,D(y))}if(b&&H(b,!0),e.base=_,_){for(var E=e,x=e;x=x._parentComponent;)E=x;_._component=E,_._componentConstructor=E.constructor}}!h||o?(ae.unshift(e),se||P()):!i&&e.componentDidUpdate&&e.componentDidUpdate(f,d,p);var M,C=e._renderCallbacks;if(C)for(;M=C.pop();)M.call(e);return s}}function Y(e,t,n,r){for(var o=e&&e._component,i=e,a=o&&e._componentConstructor===t.nodeName,s=a,c=S(t);o&&!s&&(o=o._parentComponent);)s=o.constructor===t.nodeName;return!s||r&&!o._component?(o&&!a&&(H(o,!0),e=i=null),o=B(t.nodeName,c,n),e&&!o.nextBase&&(o.nextBase=e),q(o,c,1,n,r),e=o.base,i&&e!==i&&(i._component=null,D(i))):(q(o,c,3,n,r),e=o.base),e}function H(e,t){var n=e.base;e._disableRendering=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var r=e._component;r?H(r,t):n&&(n[ee]&&n[ee].ref&&n[ee].ref(null),e.nextBase=n,t&&(_(n),U(e)),R(n.childNodes,!t)),e.__ref&&e.__ref(null),e.componentDidUnmount&&e.componentDidUnmount()}function z(e,t){this._dirty=!0,this._disableRendering=!1,this.prevState=this.prevProps=this.prevContext=this.base=this.nextBase=this._parentComponent=this._component=this.__ref=this.__key=this._linkedStates=this._renderCallbacks=null,this.context=t,this.props=e,this.state=this.getInitialState&&this.getInitialState()||{}}function W(e,t,n){return j(n,e,{},!1,t)}var G={},K={},$=function(e){return K[e]||(K[e]=e.toLowerCase())},Q="undefined"!=typeof Promise&&Promise.resolve(),X=Q?function(e){Q.then(e)}:setTimeout,J=[],Z={},ee="undefined"!=typeof Symbol?Symbol["for"]("preactattr"):"__preactattr_",te={boxFlex:1,boxFlexGroup:1,columnCount:1,fillOpacity:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,strokeOpacity:1,widows:1,zIndex:1,zoom:1},ne={blur:1,error:1,focus:1,load:1,resize:1,scroll:1},re=[],oe=[],ie={},ae=[],se=0,ce=!1,ue={};n(z.prototype,{linkState:function(e,t){var n=this._linkedStates||(this._linkedStates={}),r=e+"|"+t;return n[r]||(n[r]=p(this,e,t))},setState:function(e,t){var o=this.state;this.prevState||(this.prevState=r(o)),n(o,a(e)?e(o,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),F(this)},forceUpdate:function(){V(this,2)},render:function(){return null}}),e.h=f,e.cloneElement=d,e.Component=z,e.render=W,e.rerender=y,e.options=G})},function(e,t){"use strict";e.exports=window.__CYTRON_LIB__.debug},function(e,t){"use strict";e.exports=window.__CYTRON_LIB__.config},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.assert=t.rgba=t.uid=void 0;var o=n(29);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var i=n(32);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=n(28);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var s=n(26);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var c=n(25);Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})});var u=n(27);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var l=n(23);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var f=n(31),d=r(f),p=n(30),h=r(p),y=n(22),v=r(y),m=n(24),g=r(m);t.uid=d["default"],t.rgba=h["default"],t.assert=v["default"],t.debounce=g["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Input=t.Tooltip=t.Overlay=t.CytronPlugin=t.CytronNode=t.cx=t.pure=t.prefixer=void 0;var o=n(21),i=r(o),a=n(39),s=r(a),c=n(38),u=r(c),l=n(33),f=r(l),d=n(34),p=r(d),h=n(36),y=r(h),v=n(37),m=r(v),g=n(35),b=r(g);t.prefixer=i["default"],t.pure=s["default"],t.cx=u["default"],t.CytronNode=f["default"],t.CytronPlugin=p["default"],t.Overlay=y["default"],t.Tooltip=m["default"],t.Input=b["default"]},function(e,t){var n=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t["default"]=r({},{myStoreUrl:"http://store.videojj.com/",consoleUrl:"http://console.cdn.videojj.com",apiAddress:"http://cytron.videojj.com/api",authAddress:"http://videojj.com/api",meAddress:"http://me.videojj.com/api",vaAddress:"http://va.videojj.com",publicUrl:"https://cytroncdn.videojj.com/release/6.4.2/",coreUrl:"https://cytroncdn.videojj.com/latest/cytron.core.js",version:"6.4.2",assertsUrl:"http://cytroncdn.videojj.com/asserts",date:"2016-12-02T14:04:02.455Z",name:"cytron-platform"},{fps:2,serviceType:{videoOS:{alias:"videoOS",value:3},vor:{alias:"灵悟",value:4}},trackCategory:{videoView:{alias:"视频准备就绪",value:4},videoPause:{alias:"视频暂停",value:17},videoPlay:{alias:"视频播放",value:16},videoClose:{alias:"视频关闭",value:19},videoDrag:{alias:"视频拖动",value:18},videoFocus:{alias:"视频获取焦点",value:25},videoBlur:{alias:"视频失去焦点",value:26},tagNodeView:{alias:"热点显示",value:12},tagNodeClick:{alias:"热点点击",value:9},tagNodeHover:{alias:"热点hover",value:21},infoNodeView:{alias:"信息层显示",value:34},infoNodeClose:{alias:"信息层关闭",value:20},nodeLinkClick:{alias:"外链被点击",value:11},nodeJump:{alias:"节点跳转",value:35},mqttConnect:{alias:"连接MQTT",value:33}}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){u.length=0}function i(e,t){var n=u.join("");return t||(t=document.createElement("style"),t.setAttribute("type","text/css"),e.appendChild(t)),"textContent"in t?t.textContent=n:t.styleSheet.cssText=n,t}function a(){var e=Array.prototype.slice.call(arguments),t=c["default"].apply(null,e),n=c["default"].getCss(t);return u.indexOf(n)===-1&&u.push(n),t}Object.defineProperty(t,"__esModule",{value:!0}),t.clearCsjs=o,t.injectCsjs=i,t.csjsModule=a,t["default"]=function(){var e=Array.prototype.slice.call(arguments),t=a.apply(null,e);return Object.keys(t).reduce(function(e,n){return e[n]=t[n].toString(),e},{})};var s=n(62),c=r(s),u=[]},function(e,t){"use strict";function n(e,t,n){var r=e.join(" ");return Object.create(o.prototype,{classNames:{value:Object.freeze(e),configurable:!1,writable:!1,enumerable:!0},unscoped:{value:Object.freeze(t),configurable:!1,writable:!1,enumerable:!0},className:{value:r,configurable:!1,writable:!1,enumerable:!0},selector:{value:e.map(function(e){return n?e:"."+e}).join(", "),configurable:!1,writable:!1,enumerable:!0},toString:{value:function(){return r},configurable:!1,writeable:!1,enumerable:!1}})}function r(e){return e instanceof o}function o(){}e.exports={makeComposition:n,isComposition:r}},,function(e,t,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r),e}function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}}function s(){var e;try{e=t.storage.debug}catch(n){}return e}function c(){try{return window.localStorage}catch(e){}}t=e.exports=n(71),t.log=i,t.formatArgs=o,t.save=a,t.load=s,t.useColors=r,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(s())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(42);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){var r=n(53),o=n(9),i=n(51),a="prototype",s=function(e,t,n){var c,u,l,f=e&s.F,d=e&s.G,p=e&s.S,h=e&s.P,y=e&s.B,v=e&s.W,m=d?o:o[t]||(o[t]={}),g=d?r:p?r[t]:(r[t]||{})[a];d&&(n=t);for(c in n)u=!f&&g&&c in g,u&&c in m||(l=u?g[c]:n[c],m[c]=d&&"function"!=typeof g[c]?n[c]:y&&u?i(l,r):v&&g[c]==l?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[a]=e[a],t}(l):h&&"function"==typeof l?i(Function.call,l):l,h&&((m[a]||(m[a]={}))[c]=l))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,e.exports=s},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,n){var r=n(52);e.exports=function(e){return Object(r(e))}},function(e,t){"use strict";e.exports=" css "},,function(e,t,n){var r=n(46)["default"],o=n(45)["default"];!function(e){e()}(function(){"use strict";function t(e,t,n,i){function a(e,t){return c(n,e)&&(i||c(I,t))?n.replace(e,["",t.toLowerCase(),e].join("-")):null}function l(e){return k[e].reduce(function(t,n){return t[n.toLowerCase()]=a(e,n),t},{})}function f(n){var r=u(n).filter(function(e){return null!==e}).map(function(e){return t+":"+e}).join(";");r&&(e[t]=e[t]+";"+r)}function d(){return n.replace("flex-","").toLowerCase()}var p=!0;if("flex"===n&&"display"===t){var h=l("flex");return h.ms&&(h.ms=h.ms.replace("flex","flexbox")),f(h),p&&(e[t]="-webkit-box;display:"+e[t]),e}var y=r(k).filter(function(e){return"flex"!==e}).reduce(function(e,t){return e[t]=l(t),e},{});if(T[t]){var v=i?T[t]:T[t].filter(function(e){return c(I,e)}),m=v.reduce(function(e,o){var i=n;return r(y).forEach(function(e){var t=y[e];r(t).forEach(function(e){t[e]&&s(o)===s(e)&&(i=t[e],t[e]=null)})}),e[o+s(t)]=i,e},{});if(p)switch(t){case"flexDirection":c(n,"reverse")?m.WebkitBoxDirection="reverse":m.WebkitBoxDirection="normal",c(n,"row")?m.WebkitBoxOrient=m.boxOrient="horizontal":c(n,"column")&&(m.WebkitBoxOrient="vertical");break;case"alignSelf":m.msFlexItemAlign=d();break;case"alignItems":m.WebkitBoxAlign=m.msFlexAlign=d();break;case"alignContent":"spaceAround"===n?m.msFlexLinePack="distribute":"spaceBetween"===n?m.msFlexLinePack="justify":m.msFlexLinePack=d();break;case"justifyContent":"spaceAround"===n?m.msFlexPack="distribute":"spaceBetween"===n?m.WebkitBoxPack=m.msFlexPack="justify":m.WebkitBoxPack=m.msFlexPack=d();break;case"flexBasis":m.msFlexPreferredSize=n;break;case"order":m.msFlexOrder="-moz-calc("+n+")",m.WebkitBoxOrdinalGroup="-webkit-calc("+(parseInt(n)+1)+")";break;case"flexGrow":m.WebkitBoxFlex=m.msFlexPositive=n;break;case"flexShrink":m.msFlexNegative=n;break;case"flex":m.WebkitBoxFlex=n}o(e,m)}return r(y).forEach(function(e){f(y[e])}),e}function n(e,o){return r(e).forEach(function(r){var i=e[r];"object"==typeof i?n(i,o):e=t(e,r,i,o)}),e}function i(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return"boolean"==typeof e?function(t){return n(t,e)}:e?n(e,t):{}}var a={range:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t},capitalize:function(e){return e&&e.charAt(0).toUpperCase()+e.substring(1)},includes:function(e,t){return"number"==typeof e&&(e=e.toString()),e.indexOf(t)!==-1},values:function(e){return r(e).map(function(t){return e[t]})}},s=a.capitalize,c=a.includes,u=a.values,l="Webkit",f="Moz",d="ms",p="o",h=[l],y=[l,p],v=[f],m=[d],g=[l,f],b=[l,f,p],_=[l,f,d],w=[l,d],O=[l,d,f,p],T={alignContent:h,alignItems:h,alignSelf:h,animation:g,animationDelay:g,animationDirection:g,animationDuration:g,animationFillMode:g,animationIterationCount:g,animationName:g,animationPlayState:g,animationTimingFunction:g,appearance:g,backfaceVisibility:g,backgroundClip:h,borderImage:b,borderImageSlice:b,boxShadow:_,boxSizing:g,clipPath:h,columns:g,cursor:g,flex:w,flexBasis:w,flexDirection:w,flexFlow:w,flexGrow:w,flexShrink:w,flexWrap:w,fontSmoothing:g,justifyContent:g,order:g,perspective:g,perspectiveOrigin:g,transform:_,transformOrigin:_,transformOriginX:_,transformOriginY:_,transformOriginZ:_,transformStyle:_,transition:_,transitionDelay:_,transitionDuration:_,transitionProperty:_,transitionTimingFunction:_,userSelect:_},k={calc:g,flex:w},I=function(){if("undefined"==typeof navigator)return O;var e=navigator.userAgent;return c(e,"Chrome")?h:c(e,"Safari")?h:c(e,"Opera")?y:c(e,"Firefox")?v:c(e,"MSIE")?m:[]}();e.exports=i})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e){var r="[AssertError] "+t||"错误的值: "+e;if(n)throw new Error(r);return console.error(r),!1}return!0}},function(e,t){"use strict";function n(e){return console.group?void console.group(e):void console.log("=== GroupStart ===> ",e)}function r(e){return console.groupEnd?void console.groupEnd(e):void console.log("=== GroupEnd ===> ",e)}Object.defineProperty(t,"__esModule",{value:!0}),t.groupStartLog=n,t.groupEndLog=r},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){var r=void 0;return function(){for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];t&&!r&&n.apply(void 0,i),r&&clearTimeout(r),r=setTimeout(function(){r=null,t||n.apply(void 0,i)},e)}}}},function(e,t){"use strict";function n(e){return e&&e.nodeName?e:"string"==typeof e?0===e.indexOf(".")?document.getElementsByClassName(e.slice(1))[0]:0===e.indexOf("#")?document.getElementById(e.replace("#","")):document.getElementById(e):null}Object.defineProperty(t,"__esModule",{value:!0}),t.getElement=n},function(e,t,n){"use strict";function r(e,t){e=(0,i.isNumeric)(e)?e:0;var n=parseInt(e,10)/1e3,r=Math.floor(n/3600),o=Math.floor((n-3600*r)/60),a=Math.floor(n-3600*r-60*o);return r<10&&(r="0"+r),o<10&&(o="0"+o),a<10&&(a="0"+a),"mins"===t?o+":"+a:r+":"+o+":"+a}function o(e){var t=[1e8,59,59],n=e.split(":").map(function(e,n){return!(0,i.isNumeric)(e)||e<0?0:e>t[n]?t[n]:parseInt(e,10)});return 2===n.length?1e3*(60*Number(n[0])+Number(n[1])):1e3*(60*Number(n[0])*60+60*Number(n[1])+Number(n[2]))}Object.defineProperty(t,"__esModule",{value:!0}),t.msToHHMMSS=r,t.hhmmssToMS=o;var i=n(7)},function(e,t){"use strict";function n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight(function(e,t){return t(e)},e)}}function r(e){var t=void 0;if(null==e||"object"!=("undefined"==typeof e?"undefined":o(e)))return e;if(e instanceof Date)return t=new Date,t.setTime(e.getTime()),t;if(e instanceof Array){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=r(e[n]);return t}if(e instanceof Object){t={};for(var a in e)e.hasOwnProperty(a)&&(t[a]=r(e[a]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.compose=n,t.clone=r},function(e,t){"use strict";function n(e){return null==e||""===e||!(!Array.isArray(e)||0!==e.length)||"object"===("undefined"==typeof e?"undefined":a(e))&&0===Object.keys(e).length}function r(e){return"function"==typeof e}function o(e){return!isNaN(parseFloat(e))&&isFinite(e)}function i(e){if(!e||"object"!==("undefined"==typeof e?"undefined":a(e)))return!1;var t="function"==typeof e.constructor?Object.getPrototypeOf(e):Object.prototype;if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&s(n)===c}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isEmpty=n,t.isFunction=r,t.isNumeric=o,t.isPlainObject=i;var s=function(e){return Function.prototype.toString.call(e)},c=s(Object)},function(e,t){"use strict";function n(e){var t=e.substr(1).split("&");return t.reduce(function(e,t){var n=t.split("="),o=r(n,2),i=o[0],a=o[1];return e[decodeURIComponent(i)]=decodeURIComponent(a||""),e},{})}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance");
}}();t.parseQuery=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i;t["default"]=function(e){if(!n.test(e))return e;var t=e.match(n).filter(function(e){return 2===e.length}).map(function(e){return parseInt(e,16)}),r=t.shift()/255;return"rgba("+t.join(",")+", "+r+")"}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){return Math.random().toString(36).substr(2,9)}},function(e,t){"use strict";function n(e){return!!(e&&e._id&&e.nodes&&e.nodes.length)}function r(e){return!!(e&&e._id&&e.nodes&&e.nodes.length)}function o(e){return!!(e&&e._id&&e.nodeId&&e.nodeType)}function i(e){return!!(e&&e._id&&e.nodeId&&e.nodeType&&e.nodeData&&e.initedStyle)}Object.defineProperty(t,"__esModule",{value:!0}),t.validFlowMap=n,t.validFlowData=r,t.validFlowMapNode=o,t.validFlowDataNode=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=u(['\n  .cytronNode {\n    position: absolute;\n    display: block;\n    font-family: \'"Microsoft YaHei", "微软雅黑", "WenQuanYi Micro Hei", sans-serif\';\n    box-sizing: border-box;\n    padding: 0;\n    margin: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    color: white;\n    pointer-events: auto;\n    overflow: hidden;\n  }\n  .cytronNode.flash {\n    -webkit-animation: 0.8s ease-in-out infinite flash alternate;\n            animation: 0.8s ease-in-out infinite flash alternate;\n  }\n  @-webkit-keyframes flash {\n    from { opacity: 1; }\n    to { opacity: 0; }\n  }\n  @keyframes flash {\n    from { opacity: 1; }\n    to { opacity: 0; }\n  }\n  .cytronNode.hover {\n    z-index: 101;\n  }\n'],['\n  .cytronNode {\n    position: absolute;\n    display: block;\n    font-family: \'"Microsoft YaHei", "微软雅黑", "WenQuanYi Micro Hei", sans-serif\';\n    box-sizing: border-box;\n    padding: 0;\n    margin: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    color: white;\n    pointer-events: auto;\n    overflow: hidden;\n  }\n  .cytronNode.flash {\n    -webkit-animation: 0.8s ease-in-out infinite flash alternate;\n            animation: 0.8s ease-in-out infinite flash alternate;\n  }\n  @-webkit-keyframes flash {\n    from { opacity: 1; }\n    to { opacity: 0; }\n  }\n  @keyframes flash {\n    from { opacity: 1; }\n    to { opacity: 0; }\n  }\n  .cytronNode.hover {\n    z-index: 101;\n  }\n']),p=n(4),h=n(11),y=o(h),v=n(15),m=r(v),g=n(7),b=n(8),_=n(10),w=o(_),O=n(14)("cy:CytronNode"),T=w["default"].trackCategory,k=(0,y["default"])(d),I={enterTimeout:500,enterDelay:100,leaveTimeout:300,leaveDelay:0,enter:{opacity:0,transform:"translateY(-40px)"},active:{opacity:1,transform:"none"},leave:{opacity:0,transform:"translateY(-40px)"}};t["default"]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return function(n){var r,o=(0,b.pure)(r=function(e){function t(e,r){a(this,t);var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));o.triggerPortOut=function(e,t){if(!o.context.isEditing){if("SLOT_CLOSE"===e){var r=n.transitions||I,i=r.leave,a=r.leaveTimeout,s=void 0===a?0:a,c=r.leaveDelay,u=void 0===c?0:c,f=r.property,d=void 0===f?"opacity, transform":f,p=r.timingFunction,h=void 0===p?"ease":p;return o.setState({transitionStyle:(0,b.prefixer)(l({},i,{transitionProperty:d,transitionDelay:u+"ms",transitionDuration:s+"ms",transitionTimingFunction:h}))}),void setTimeout(o.doTriggerPortOut,s+u,e,t)}o.doTriggerPortOut(e,t)}},o.doTriggerPortOut=function(e,t){var n=o.context.actions,r=o.props.node;O("triggerPortOut",e,t,r),n&&n.scene.triggerNext(r,e,t).dispatchAync()},o.triggerVoteGet=function(e,t){if(o.context.isEditing)return Promise.resolve(e?void 0:{});var n=o.context.ajax,r=o.props.node,i=r._id+"-vote-"+(e||"all");return o.cache[i]?Promise.resolve(o.cache[i]):n.get("/flow/vote",{nodeId:t||r.nodeId,flowId:r._flowId,optionId:e}).then(function(t){var n=t.data,r=e?n[e]:n;return o.cache[i]=r,r})},o.triggerVoteCall=function(e,t){if(o.context.isEditing)return Promise.resolve({});if(!e&&!t)return console.warn("VoteCall 数据不完整 optionId: "+e+", nodeId: "+t),Promise.resolve({});var n=o.context,r=n.ajax,i=n.session,a=o.props.node,s=a._id+"-vote-"+(e||"all");return o.cache[s]=void 0,r.post("/flow/vote",{optionId:e,nodeId:t||a.nodeId,flowId:a._flowId}).then(function(t){var n=i.storage.get("options")||[],r=i.getVideoId()+"-"+e;return n.indexOf(r)===-1&&n.push(r),i.storage.set("options",n),t})},o.triggerTrackApiCall=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o.context.isEditing){var n=o.context.track,r=o.props.node,i=l({cat:e,tag:r._flowId,dg:r._resourceId},t);n(i)}},o.triggerMonitorCall=function(e,t){!o.context.isEditing&&Array.isArray(t)&&t.forEach(function(t){return t.type===e&&o.context.monitor(t)})},o.onNodeHover=function(){o.state.isHover||(o.props.node.isTag&&o.triggerTrackApiCall(T.tagNodeHover),o.setState({isHover:!0}))},o.onNodePress=function(e){return e.stopPropagation()},o.onNodeRealease=function(){return o.setState({isHover:!1})},o.onNodeClicked=function(){var e=o.props.node;if(e.isTag){o.triggerTrackApiCall(T.tagNodeClick);var t=o.context.player.checkDot;t&&t(e._id)}var n=e.nodeData;o.triggerMonitorCall("click",n&&n.monitors)},o.startTrackStyleUpdater=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o.trackUpdateTimerId||!t){o.stopTrackStyleUpdater();var n=o.props.node,r=n.tracks,i=n.nodeData,a=i&&i.autoTrack;if(r&&r.length&&a){var s=o.context.player.getTime()||0,c=r.reduce(function(e,t,n){var o=t.time;if(!(0,g.isEmpty)(e))return e;var i=r[n+1];return o<=s&&i&&s<=i.time&&m.assign(e,i,{idx:n}),e},{});if((0,g.isEmpty)(c)){var u=r[0];if(u&&u.time>s)return void o.setState({trackStyle:l({},u,{display:"none"})});var f=r[r.length-1];return f&&f.time<s?void o.setState({trackStyle:l({},f,{display:"none"})}):void o.setState({trackStyle:null})}var d=o.state.trackStyle,p=Math.abs(c.time-s),h=d?Math.abs(d.time-c.time):0,y=h>1e3||p>1e3,v=y?{opacity:0,transition:"none"}:{opacity:1,transition:"all "+p+"ms linear"},b=y?p-200:p,_=l({},c,v),w=!d||d.idx!==_.idx||d.transition!==_.transition;w&&o.setState({trackStyle:_}),e&&(o.trackUpdateTimerId=setTimeout(o.startTrackStyleUpdater,b))}}},o.stopTrackStyleUpdater=function(){o.trackUpdateTimerId&&(clearTimeout(o.trackUpdateTimerId),o.trackUpdateTimerId=void 0)},o.formatStyle=function(e){var t=["top","left","bottom","right","width","height"],n=["which","ratio"],r=Object.keys(e||{}).reduce(function(r,o){if(n.indexOf(o)!==-1)return r;var i=e[o];return t.indexOf(o)!==-1?r[o]=(0,g.isNumeric)(i)?100*i+"%":i:r[o]=i,r},{}),i=o.props.canDisplay,a=void 0===i||i;return m.assign(r,!a&&{display:"none"})};var i=n.transitions||I,c=i.enter,u=(0,b.prefixer)(l({},c));return o.state={transitionStyle:u},o.cache={},o}return c(t,e),f(t,[{key:"getChildContext",value:function(){return{triggerTrackApiCall:this.triggerTrackApiCall,triggerMonitorCall:this.triggerMonitorCall,triggerVoteCall:this.triggerVoteCall,triggerVoteGet:this.triggerVoteGet,getLayout:this.getLayout,formatStyle:this.formatStyle}}},{key:"getLayout",value:function(e){return e<480?"min":e>720?"max":"mid"}},{key:"triggerComponentDidReady",value:function(){this.$node&&this.$node.componentDidReady&&setTimeout(this.$node.componentDidReady.bind(this.$node,!0))}},{key:"componentDidMount",value:function(){var e=this;this.mountTimer=setTimeout(function(){var t=e.context.rootElement,r=e.props.node;if(e.nodeMountTime=Date.now(),r.isTag){var o=r.initedStyle||{},i=o.left,a=o.top,s=t.getBoundingClientRect(),c=Math.round(i/s.width),u=Math.round(a/s.height);e.triggerTrackApiCall(T.tagNodeView,{x:c,y:u})}else e.triggerTrackApiCall(T.infoNodeView);e.triggerMonitorCall("show",r.nodeData.monitors),e.base.addEventListener("click",e.onNodeClicked),e.base.addEventListener("mouseover",e.onNodeHover),e.base.addEventListener("mousedown",e.onNodePress),e.base.addEventListener("mouseleave",e.onNodeRealease);var f=n.transitions||I,d=f.active,p=f.enterTimeout,h=void 0===p?0:p,y=f.enterDelay,v=void 0===y?0:y,m=f.property,g=void 0===m?"opacity, transform":m,_=f.timingFunction,w=void 0===_?"ease":_,O=(0,b.prefixer)(l({},d,{transitionProperty:g,transitionDelay:v+"ms",transitionDuration:h+"ms",transitionTimingFunction:w}));e.setState({transitionStyle:O}),e.triggerComponentDidReady(),e.startTrackStyleUpdater(e.props.isPlaying)})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.mountTimer);var e=Date.now()-this.nodeMountTime;this.base.removeEventListener("click",this.onNodeClicked),this.base.removeEventListener("mouseover",this.onNodeHover),this.base.removeEventListener("mousedown",this.onNodePress),this.base.removeEventListener("mouseleave",this.onNodeRealease),this.props.node.isTag||this.triggerTrackApiCall(T.infoNodeClose,{dr:e}),this.stopTrackStyleUpdater()}},{key:"componentDidUpdate",value:function(){this.context.isEditing&&this.triggerComponentDidReady()}},{key:"componentWillReceiveProps",value:function(e){var t=e.trackTime,n=e.isPlaying,r=Math.abs(t-this.props.trackTime)>0,o=n&&!this.props.isPlaying;o||r?this.startTrackStyleUpdater(n,r):n||this.stopTrackStyleUpdater()}},{key:"render",value:function(e,t,r){var o,a=this,s=(0,b.cx)(k.cytronNode,(o={},i(o,k.flash,r.isEditing&&e.node.nodeData.autoHidden),i(o,k.hover,t.isHover),o)),c=t.trackStyle,u=c?l({left:c.left+c.width,top:c.top+c.height/2},"none"!==c.display&&{opacity:c.opacity,transition:c.transition||"none"}):{};return(0,p.h)(n,{ref:function(e){a.$node=e},className:s,style:l({},t.transitionStyle,this.formatStyle(l({},e.style,u))),trackStyle:c,triggerPortOut:this.triggerPortOut,node:e.node})}}]),t}(p.Component))||r;return"defineCytronModule"in window&&defineCytronModule("module."+e+"."+t,function(n,r){return{nodeType:e,theme:t,component:o}}),o}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t["default"]=function(e,t){return function(n){var o=(0,r.pure)(n);return"defineCytronModule"in window&&defineCytronModule("plugin."+e,function(n,r){return{name:e,reducer:t.reducer,defaultState:t.defaultState,component:o}}),o}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(4),u=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.onKeyUp=function(e){if(i.props.onKeyUp){var t=e.target.value;i.setState({value:t}),i.props.onKeyUp&&i.props.onKeyUp(t)}},i.onChange=function(e){var t=e.target.value;i.setState({value:t}),i.props.onChange&&i.props.onChange(t)},i.onBlur=function(e){var t=e.target.value;i.setState({value:t}),i.props.onBlur&&i.props.onBlur(t)},i.getValue=function(){return i.state.value},i.state={value:e.defaultValue||e.value||""},i}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&e.value!==this.state.value&&this.setState({value:e.value})}},{key:"render",value:function(e,t){var n=t.value;return(0,c.h)("input",a({},e,{value:n,onKeyUp:this.onKeyUp,onChange:this.onChange,onBlur:this.onBlur}))}}]),t}(c.Component);t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(4),u=n(7),l=n(10),f=r(l),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.context.rootElement;this.portal=document.createElement("div"),this.portal.id="cytron-overlay-"+(0,u.uid)(),this.portal.className=f["default"].name,e.appendChild(this.portal),this.renderPortal(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.renderPortal(e)}},{key:"componentWillUnmount",value:function(){this.renderPortal(null);var e=this.portal.parentElement;e&&e.removeChild(this.portal)}},{key:"renderPortal",value:function(e){this.modal=(0,c.render)(e?(0,c.h)("span",e,e.children):(0,c.h)("span",null),this.portal,this.modal)}},{key:"render",value:function(){return null}}]),t}(c.Component);t["default"]=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=s(["\n  .tooltip {\n    display: block;\n    position: absolute;\n    background: white;\n    color: #7B93A7;\n    border-radius: 2px;\n    z-index: 1000;\n    padding: 5px 8px;\n    font-size: 12px;\n    box-shadow: 0 2px 4px 0px rgba(0,0,0,0.2);\n    -webkit-animation: 0.1s linear 0.3s backwards fadeIn;\n            animation: 0.1s linear 0.3s backwards fadeIn;\n    white-space: nowrap;\n  }\n\n  .tooltip:before, .tooltip:after {\n    content: '';\n    position: absolute;\n    width: ","px;\n    height: ","px;\n    border: ","px solid transparent;\n  }\n  .tooltip:after {\n    width: ","px;\n    height: ","px;\n    border: ","px solid transparent;\n  }\n\n  .tooltip.top {\n    -webkit-transform: translateX(-50%) translateY(calc(-100% - ","px));\n            transform: translateX(-50%) translateY(calc(-100% - ","px));\n  }\n  .tooltip.top:before,\n  .tooltip.top:after {\n    top: 100%;\n    left: 50%;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%);\n    border-bottom: 1px solid transparent;\n    border-top: ",";\n  }\n  .tooltip.top:after {\n    border-top: ",";\n  }\n\n  .tooltip.bottom {\n    -webkit-transform: translateX(-50%) translateY(","px);\n            transform: translateX(-50%) translateY(","px);\n  }\n  .tooltip.bottom:before,\n  .tooltip.bottom:after {\n    bottom: 100%;\n    left: 50%;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%);\n    border-top: 1px solid transparent;\n    border-bottom: ",";\n  }\n  .tooltip.bottom:after {\n    border-bottom: ",";\n  }\n\n  .tooltip.left {\n    -webkit-transform: translateX(calc(-100% - ","px)) translateY(-50%);\n            transform: translateX(calc(-100% - ","px)) translateY(-50%);\n  }\n  .tooltip.left:before,\n  .tooltip.left:after {\n    left: 100%;\n    top: 50%;\n    -webkit-transform: translateY(-50%);\n            transform: translateY(-50%);\n    border-right: 1px solid transparent;\n    border-left: ",";\n  }\n  .tooltip.left:after {\n    border-left: ",";\n  }\n\n  .tooltip.right {\n    -webkit-transform: translateX(","px) translateY(-50%);\n            transform: translateX(","px) translateY(-50%);\n  }\n  .tooltip.right:before,\n  .tooltip.right:after {\n    right: 100%;\n    top: 50%;\n    -webkit-transform: translateY(-50%);\n            transform: translateY(-50%);\n    border-left: 1px solid transparent;\n    border-right: ",";\n  }\n  .tooltip.right:after {\n    border-right: ",";\n  }\n\n  @-webkit-keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"],["\n  .tooltip {\n    display: block;\n    position: absolute;\n    background: white;\n    color: #7B93A7;\n    border-radius: 2px;\n    z-index: 1000;\n    padding: 5px 8px;\n    font-size: 12px;\n    box-shadow: 0 2px 4px 0px rgba(0,0,0,0.2);\n    -webkit-animation: 0.1s linear 0.3s backwards fadeIn;\n            animation: 0.1s linear 0.3s backwards fadeIn;\n    white-space: nowrap;\n  }\n\n  .tooltip:before, .tooltip:after {\n    content: '';\n    position: absolute;\n    width: ","px;\n    height: ","px;\n    border: ","px solid transparent;\n  }\n  .tooltip:after {\n    width: ","px;\n    height: ","px;\n    border: ","px solid transparent;\n  }\n\n  .tooltip.top {\n    -webkit-transform: translateX(-50%) translateY(calc(-100% - ","px));\n            transform: translateX(-50%) translateY(calc(-100% - ","px));\n  }\n  .tooltip.top:before,\n  .tooltip.top:after {\n    top: 100%;\n    left: 50%;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%);\n    border-bottom: 1px solid transparent;\n    border-top: ",";\n  }\n  .tooltip.top:after {\n    border-top: ",";\n  }\n\n  .tooltip.bottom {\n    -webkit-transform: translateX(-50%) translateY(","px);\n            transform: translateX(-50%) translateY(","px);\n  }\n  .tooltip.bottom:before,\n  .tooltip.bottom:after {\n    bottom: 100%;\n    left: 50%;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%);\n    border-top: 1px solid transparent;\n    border-bottom: ",";\n  }\n  .tooltip.bottom:after {\n    border-bottom: ",";\n  }\n\n  .tooltip.left {\n    -webkit-transform: translateX(calc(-100% - ","px)) translateY(-50%);\n            transform: translateX(calc(-100% - ","px)) translateY(-50%);\n  }\n  .tooltip.left:before,\n  .tooltip.left:after {\n    left: 100%;\n    top: 50%;\n    -webkit-transform: translateY(-50%);\n            transform: translateY(-50%);\n    border-right: 1px solid transparent;\n    border-left: ",";\n  }\n  .tooltip.left:after {\n    border-left: ",";\n  }\n\n  .tooltip.right {\n    -webkit-transform: translateX(","px) translateY(-50%);\n            transform: translateX(","px) translateY(-50%);\n  }\n  .tooltip.right:before,\n  .tooltip.right:after {\n    right: 100%;\n    top: 50%;\n    -webkit-transform: translateY(-50%);\n            transform: translateY(-50%);\n    border-left: 1px solid transparent;\n    border-right: ",";\n  }\n  .tooltip.right:after {\n    border-right: ",";\n  }\n\n  @-webkit-keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n\n  @keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n  }\n"]),f=n(4),d=n(8),p=n(11),h=r(p),y={arrowSize:6,arrowBorder:"6px solid rgba(0,0,0,0.08);",arrowBg:"5px solid white;",margin:5},v=(0,h["default"])(l,y.arrowSize,y.arrowSize,y.arrowSize,y.arrowSize-1,y.arrowSize-1,y.arrowSize-1,y.arrowSize+y.margin,y.arrowSize+y.margin,y.arrowBorder,y.arrowBg,y.arrowSize+y.margin,y.arrowSize+y.margin,y.arrowBorder,y.arrowBg,y.arrowSize+y.margin,y.arrowSize+y.margin,y.arrowBorder,y.arrowBg,y.arrowSize+y.margin,y.arrowSize+y.margin,y.arrowBorder,y.arrowBg),m=function(e){function t(){var e,n,r,a;o(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.getPlacementStyle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"top",t=r.context.rootElement.getBoundingClientRect(),n=t.left,o=t.top,i=r.base.firstChild&&"function"==typeof r.base.firstChild.getBoundingClientRect,a=(i?r.base.firstChild:r.base).getBoundingClientRect(),s=a.height,c=a.width,u=a.top,l=a.left;switch(e){case"top":return{left:l-n+c/2+"px",top:u-o+"px"};case"bottom":return{left:l-n+c/2+"px",top:u-o+s+"px"};case"left":return{left:l-n+"px",top:u-o+s/2+"px"};case"right":return{left:l-n+c+"px",top:u-o+s/2+"px"};default:throw new Error("unknown placement "+e)}},r.onTooltipShow=function(){r.setState({isShow:!0,textStyle:r.getPlacementStyle(r.props.placement)})},r.onTooltipHide=function(){r.setState({isShow:!1})},a=n,i(r,a)}return a(t,e),u(t,[{key:"render",value:function(e,t){return(0,f.h)("span",c({},e,{onMouseOver:this.onTooltipShow,onMouseLeave:this.onTooltipHide}),e.children,e.text&&t.isShow&&(0,f.h)(d.Overlay,{className:(0,d.cx)(v.tooltip,v[e.placement||"top"]),style:t.textStyle},e.text))}}]),t}(f.Component);t["default"]=m},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t["default"]=function(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o="undefined"==typeof r?"undefined":n(r);if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r))e.push(classNames.apply(null,r));else if("object"===o)for(var i in r)({}).hasOwnProperty.call(r,i)&&r[i]&&e.push(i)}}return e.join(" ")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(40),i=r(o);t["default"]=function(e){return e.prototype.shouldComponentUpdate=function(e,t){return!(0,i["default"])(this.props,e)||!(0,i["default"])(this.state,t)},e}},function(e,t){"use strict";function n(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}function r(e,t){if(n(e,t))return!0;if("object"!==("undefined"==typeof e?"undefined":o(e))||null===e||"object"!==("undefined"==typeof t?"undefined":o(t))||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(var s=0;s<r.length;s++)if(!i.call(t,r[s])||!n(e[r[s]],t[r[s]]))return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.prototype.hasOwnProperty;t["default"]=r},function(e,t){"use strict";function n(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;i<r;i++)if(t=n[i],e.call(o,t,i,n))return t}function r(e){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;i<r;i++)if(t=n[i],e.call(o,t,i,n))return i;return-1}function o(e,t){return n.call(e,t)}function i(e,t){return r.call(e,t)}function a(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),n=t.length>>>0,r=arguments[1],o=r>>0,i=o<0?Math.max(n+o,0):Math.min(o,n),a=arguments[2],s=void 0===a?n:a>>0,c=s<0?Math.max(n+s,0):Math.min(s,n);i<c;)t[i]=e,i++;return t}function s(e,t){return a.call(e,t)}function c(e){var t=Object(this),n=parseInt(t.length)||0;if(0===n)return!1;var r,o=parseInt(arguments[1])||0;o>=0?r=o:(r=n+o,r<0&&(r=0));for(var i;r<n;){if(i=t[r],e===i||e!==e&&i!==i)return!0;r++}return!1}function u(e,t){return c.call(e,t)}function l(){var e=[];return this.forEach(function(t){e=e.concat(t)}),e}function f(e){return l.call(e)}function d(e,t){return f(e.map(t))}function p(e,t){return e.indexOf(t)!==-1}function h(){Array.prototype.concatAll||(Array.prototype.concatAll=l),Array.prototype.includes||(Array.prototype.includes=c),Array.prototype.find||(Array.prototype.find=n),Array.prototype.fill||(Array.prototype.fill=a)}Object.defineProperty(t,"__esModule",{value:!0}),t.find=o,t.findIndex=i,t.fill=s,t.includes=u,t.concatAll=f,t.concatMap=d,t.contains=p,t.ArrayPolyfill=h},function(e,t){"use strict";function n(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.assign=n,"function"!=typeof Object.assign&&(Object.assign=n)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){return t||(t=document.createElement("style"),e.append(t,e.firstChild)),t.innerHTML=c.replace(/(\t|\r|\n)/g,""),t}Object.defineProperty(t,"__esModule",{value:!0}),t.resetCSSText=void 0,t["default"]=function(e){if(e&&e.nodeName){var t=e.style.position;["fixed","absolute","relative"].indexOf(t)===-1&&(e.style.position="relative");var n=document.createElement("style");return n.innerHTML=c.replace(/(\t|\r|\n)/g,""),e.insertBefore(n,e.firstChild),n}throw new Error(e+"容器不是一个HTMLElement")},t.injectResetCss=o;var i=n(6),a=r(i),s=a["default"].name,c=t.resetCSSText="\n."+s+" *,\n."+s+" *:before,\n."+s+" *:after {\n  font-family: 'PingFang SC', Helvetica, '微软雅黑', '黑体', Arial, 'Lucida Grande', sans-serif !important;\n  box-sizing: border-box;\n  -webkit-font-smoothing: antialiased;\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\n  font-weight: 500;\n}\n."+s+" audio,\n."+s+" canvas,\n."+s+" video { display:inline-block; }\n."+s+" audio:not([controls]) { display:none;height:0; }\n."+s+" a:active,\n."+s+" a:hover { outline:0; }\n."+s+" b,strong { font-weight:bold; }\n."+s+" hr { -moz-box-sizing:content-box; box-sizing:content-box;height:0; }\n."+s+" code,\n."+s+" pre,\n."+s+" samp { font-family:monospace,serif;font-size:1em; }\n."+s+" pre { white-space:pre-wrap; }\n."+s+' q { quotes:"\\201C" "\\201D" "\\2018" "\\2019"; }\n.'+s+" small { font-size:80%; }\n."+s+" img { border:0; }\n."+s+" svg:not(:root) { overflow:hidden; }\n."+s+" figure { margin:0; }\n."+s+" fieldset { border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em; }\n."+s+" button,\n."+s+" input,\n."+s+" select,\n."+s+" textarea { font-family:inherit; font-size:100%; margin:0; resize: none; }\n."+s+" button,\n."+s+" input { line-height:normal; }\n."+s+" button,\n."+s+" select { text-transform:none; }\n."+s+" button,\n."+s+' input[type="button"],\n.'+s+' input[type="reset"],\n.'+s+' input[type="submit"] { -webkit-appearance:button;cursor:pointer; }\n.'+s+" button[disabled],\n."+s+" input[disabled] { cursor:default; }\n."+s+' input[type="checkbox"],\n.'+s+' input[type="radio"] { box-sizing:border-box;padding:0; }\n.'+s+' input[type="search"] { -webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box; }\n.'+s+' input[type="search"]::-webkit-search-cancel-button,\n.'+s+' input[type="search"]::-webkit-search-decoration { -webkit-appearance:none; }\n.'+s+" button::-moz-focus-inner,\n."+s+" input::-moz-focus-inner { border:0;padding:0; }\n."+s+" textarea { overflow:auto;vertical-align:top; }\n."+s+" .clearfix:after,\n."+s+' .clearfix:before { content: " "; display: table; }\n.'+s+" .clearfix:after { clear: both; }\n."+s+" {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  border: none;\n  display: block;\n  line-height: 1;\n  overflow: hidden;\n  pointer-events: none;\n  background: none;\n  z-index: 100;\n}\n"},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(4),s=o(a),c=n(14),u=o(c),l=n(10),f=o(l),d=n(11),p=r(d),h=n(7),y=r(h),v=n(8),m=r(v),g=n(15),b=r(g),_=y.parseQuery(location.search),w=_.cyDebug&&"false"!==_.cyDebug;f["default"].debug||u["default"].disable(),w&&u["default"].enable("cy:*"),window.__CYTRON_LIB__||Object.defineProperty(window,"__CYTRON_LIB__",{value:{preact:s["default"],debug:u["default"],csjs:p,helper:y,jsxKit:m,polyfills:b,config:i({},f["default"],{debug:f["default"].debug||w})}}),t["default"]=function(e){var t=f["default"].version,n=f["default"].date;console.log("%c🚀 "+e+"@"+t+" update on "+new Date(n).toLocaleString(),"color:#888;")}},function(e,t,n){e.exports={"default":n(47),__esModule:!0}},function(e,t,n){e.exports={"default":n(48),__esModule:!0}},function(e,t,n){n(58),e.exports=n(9).Object.assign},function(e,t,n){n(59),e.exports=n(9).Object.keys},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1);
}},function(e,t,n){var r=n(49);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(50);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(e,t,n){var r=n(55),o=n(18),i=n(54);e.exports=n(17)(function(){var e=Object.assign,t={},n={},r=Symbol(),o="abcdefghijklmnopqrst";return t[r]=7,o.split("").forEach(function(e){n[e]=e}),7!=e({},t)[r]||Object.keys(e({},n)).join("")!=o})?function(e,t){for(var n=o(e),a=arguments,s=a.length,c=1,u=r.getKeys,l=r.getSymbols,f=r.isEnum;s>c;)for(var d,p=i(a[c++]),h=l?u(p).concat(l(p)):u(p),y=h.length,v=0;y>v;)f.call(p,d=h[v++])&&(n[d]=p[d]);return n}:Object.assign},function(e,t,n){var r=n(16),o=n(9),i=n(17);e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*i(function(){n(1)}),"Object",a)}},function(e,t,n){var r=n(16);r(r.S+r.F,"Object",{assign:n(56)})},function(e,t,n){var r=n(18);n(57)("keys",function(e){return function(t){return e(r(t))}})},function(e,t,n){"use strict";e.exports=n(65)},function(e,t,n){"use strict";e.exports=n(67)},function(e,t,n){"use strict";var r=n(60);e.exports=r,e.exports.csjs=r,e.exports.getCss=n(61)},function(e,t){"use strict";var n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";e.exports=function(e){if(0===e)return"0";for(var t="";e>0;)t=n[e%62]+t,e=Math.floor(e/62);return t}},function(e,t,n){"use strict";function r(e){function t(e){return Object.keys(e).forEach(function(o){n[o]||(n[o]=!0,r.push(o),t(e[o]))})}var n={},r=[];return t(e),r}var o=n(12).makeComposition;e.exports=function(e,t,n){var i=Object.keys(t).reduce(function(e,n){var r=t[n];return e[r]=o([n],[r],!0),e},{}),a=Object.keys(e).reduce(function(t,i){var a=e[i],s=n[i],c=s?r(s):[],u=[i].concat(c),l=u.map(function(t){return e[t]?e[t]:t});return t[a]=o(u,l),t},i);return a}},function(e,t,n){"use strict";function r(e){return s(e)?e.selector:e}function o(e,t){return e.map(function(e,n){return n!==t.length?e+t[n]:e}).join("")}function i(e,t){return Object.keys(e).reduce(function(n,r){return t[r]||(n[r]=e[r]),n},{})}var a=n(66),s=n(12).isComposition,c=n(64),u=n(70),l=n(19);e.exports=function(e){for(var t=Array(arguments.length-1),n=1;n<arguments.length;n++)t[n-1]=arguments[n];var f=o(e,t.map(r)),d=t.reduce(function(e,t){return s(t)&&t.classNames.forEach(function(n,r){e[n]=t.unscoped[r]}),e},{}),p=u(f,d),h=a(p.css),y=i(p.classes,d),v=i(p.keyframes,d),m=h.compositions,g=c(y,v,m);return Object.defineProperty(g,l,{enumerable:!1,configurable:!1,writeable:!1,value:h.css})}},function(e,t,n){"use strict";function r(e){return e.split(",").map(o)}function o(e){var t=e.trim();return"."===t[0]?t.substr(1):t}var i=(n(12).makeComposition,/\.([^\s]+)(\s+)(extends\s+)(\.[^{]+)/g);e.exports=function(e){function t(e,t){var n=o(t[1]),i=t[3],a=t[4],s=t.index+t[1].length+t[2].length,c=i.length+a.length;e.css=e.css.slice(0,s)+" "+e.css.slice(s+c+1);var u=r(a);return u.forEach(function(t){e.compositions[n]||(e.compositions[n]={}),e.compositions[t]||(e.compositions[t]={}),e.compositions[n][t]=e.compositions[t]}),e}for(var n,a=[];n=i.exec(e);)a.unshift(n);return a.reduce(t,{css:e,compositions:{}})}},function(e,t,n){"use strict";var r=n(19);e.exports=function(e){return e[r]}},function(e,t){"use strict";e.exports=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0}},function(e,t,n){"use strict";var r=n(63),o=n(68);e.exports=function(e){var t=r(o(e));return function(e){return e+"_"+t}}},function(e,t,n){"use strict";function r(e,t){function n(e,n){function o(o,i,a){var s=t[a]?a:r(a);return e[n][s]=a,i+s}var i=a[n];return{css:e.css.replace(i,o),keyframes:e.keyframes,classes:e.classes}}var r=i(e),a={classes:u,keyframes:l},s=Object.keys(a).reduce(n,{css:e,keyframes:{},classes:{}});return o(s)}function o(e){var t=Object.keys(e.keyframes).reduce(function(t,n){return t[e.keyframes[n]]=n,t},{}),n=Object.keys(t);if(n.length){var r="((?:animation|animation-name)\\s*:[^};]*)("+n.join("|")+")([;\\s])"+c,o=new RegExp(r,"g"),i=e.css.replace(o,function(e,n,r,o){return n+t[r]+o});return{css:i,keyframes:e.keyframes,classes:e.classes}}return e}var i=n(69),a=/(\.)(?!\d)([^\s\.,{\[>+~#:)]*)(?![^{]*})/.source,s=/(@\S*keyframes\s*)([^{\s]*)/.source,c=/(?!(?:[^*\/]|\*[^\/]|\/[^*])*\*+\/)/.source,u=new RegExp(a+c,"g"),l=new RegExp(s+c,"g");e.exports=r},function(e,t,n){function r(){return t.colors[l++%t.colors.length]}function o(e){function n(){}function o(){var e=o,n=+new Date,i=n-(u||n);e.diff=i,e.prev=u,e.curr=n,u=n,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=r());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;s++;var o=t.formatters[r];if("function"==typeof o){var i=a[s];n=o.call(e,i),a.splice(s,1),s--}return n}),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var c=o.log||t.log||console.log.bind(console);c.apply(e,a)}n.enabled=!1,o.enabled=!0;var i=t.enabled(e)?o:n;return i.namespace=e,i}function i(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,o=0;o<r;o++)n[o]&&(e=n[o].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function a(){t.enable("")}function s(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=o,t.coerce=c,t.disable=a,t.enable=i,t.enabled=s,t.humanize=n(72),t.names=[],t.skips=[],t.formatters={};var u,l=0},function(e,t){function n(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*l;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function r(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function o(e){return i(e,u,"day")||i(e,c,"hour")||i(e,s,"minute")||i(e,a,"second")||e+" ms"}function i(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,u=24*c,l=365.25*u;e.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t["long"]?o(e):r(e)}},,,,,function(e,t){"use strict";e.exports=window.__CYTRON_LIB__.helper},,,,,function(e,t){"use strict";e.exports=window.__CYTRON_LIB__.polyfills},,,,,,,,,,,,,,function(e,t,n){(function(t,r){!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function o(e){return"function"==typeof e}function i(e){$=e}function a(e){Q=e}function s(){return function(){return t.nextTick(d)}}function c(){return function(){K(d)}}function u(){var e=0,t=new Z(d),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=d,function(){return e.port2.postMessage(0)}}function f(){var e=setTimeout;return function(){return e(d,1)}}function d(){for(var e=0;e<G;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}G=0}function p(){try{var e=n(172);return K=e.runOnLoop||e.runOnContext,c()}catch(t){return f()}}function h(e,t){var n=arguments,r=this,o=new this.constructor(v);void 0===o[oe]&&R(o);var i=r._state;return i?!function(){var e=n[i-1];Q(function(){return j(i,o,e,r._result)})}():x(r,o,e,t),o}function y(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(v);return k(n,e),n}function v(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(t){return ce.error=t,ce}}function _(e,t,n,r){try{e.call(t,n,r)}catch(o){return o}}function w(e,t,n){Q(function(e){var r=!1,o=_(n,t,function(n){r||(r=!0,t!==n?k(e,n):E(e,n))},function(t){r||(r=!0,S(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,S(e,o))},e)}function O(e,t){t._state===ae?E(e,t._result):t._state===se?S(e,t._result):x(t,void 0,function(t){return k(e,t)},function(t){return S(e,t)})}function T(e,t,n){t.constructor===e.constructor&&n===h&&t.constructor.resolve===y?O(e,t):n===ce?S(e,ce.error):void 0===n?E(e,t):o(n)?w(e,t,n):E(e,t)}function k(t,n){t===n?S(t,m()):e(n)?T(t,n,b(n)):E(t,n)}function I(e){e._onerror&&e._onerror(e._result),M(e)}function E(e,t){e._state===ie&&(e._result=t,e._state=ae,0!==e._subscribers.length&&Q(M,e))}function S(e,t){e._state===ie&&(e._state=se,e._result=t,Q(I,e))}function x(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+ae]=n,o[i+se]=r,0===i&&e._state&&Q(M,e)}function M(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?j(n,r,o,i):o(i);e._subscribers.length=0}}function C(){this.error=null}function P(e,t){try{return e(t)}catch(n){return ue.error=n,ue}}function j(e,t,n,r){var i=o(n),a=void 0,s=void 0,c=void 0,u=void 0;if(i){if(a=P(n,r),a===ue?(u=!0,s=a.error,a=null):c=!0,t===a)return void S(t,g())}else a=r,c=!0;t._state!==ie||(i&&c?k(t,a):u?S(t,s):e===ae?E(t,a):e===se&&S(t,a))}function N(e,t){try{t(function(t){k(e,t)},function(t){S(e,t)})}catch(n){S(e,n)}}function A(){return le++}function R(e){e[oe]=le++,e._state=void 0,e._result=void 0,e._subscribers=[]}function D(e,t){this._instanceConstructor=e,this.promise=new e(v),this.promise[oe]||R(this.promise),W(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&E(this.promise,this._result))):S(this.promise,L())}function L(){return new Error("Array Methods must be provided an Array")}function U(e){return new D(this,e).promise}function B(e){var t=this;return new t(W(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function F(e){var t=this,n=new t(v);return S(n,e),n}function q(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Y(e){this[oe]=A(),this._result=this._state=void 0,this._subscribers=[],v!==e&&("function"!=typeof e&&q(),this instanceof Y?N(this,e):V())}function H(){var e=void 0;if("undefined"!=typeof r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var o=null;try{o=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===o&&!n.cast)return}e.Promise=Y}var z=void 0;z=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var W=z,G=0,K=void 0,$=void 0,Q=function(e,t){ne[G]=e,ne[G+1]=t,G+=2,2===G&&($?$(d):re())},X="undefined"!=typeof window?window:void 0,J=X||{},Z=J.MutationObserver||J.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof t&&"[object process]"==={}.toString.call(t),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),re=void 0;re=ee?s():Z?u():te?l():void 0===X?p():f();var oe=Math.random().toString(36).substring(16),ie=void 0,ae=1,se=2,ce=new C,ue=new C,le=0;return D.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ie&&n<e;n++)this._eachEntry(t[n],n)},D.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===y){var o=b(e);if(o===h&&e._state!==ie)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===Y){var i=new n(v);T(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},D.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===ie&&(this._remaining--,e===se?S(r,n):this._result[t]=n),0===this._remaining&&E(r,this._result)},D.prototype._willSettleAt=function(e,t){var n=this;x(e,void 0,function(e){return n._settledAt(ae,t,e)},function(e){return n._settledAt(se,t,e)})},Y.all=U,Y.race=B,Y.resolve=y,Y.reject=F,Y._setScheduler=i,Y._setAsap=a,Y._asap=Q,Y.prototype={constructor:Y,then:h,"catch":function(e){return this.then(null,e)}},H(),Y.polyfill=H,Y.Promise=Y,Y})}).call(t,n(149),function(){return this}())},function(e,t,n){"use strict";function r(e){return new i.Promise(function(t,n){var r=document.getElementsByTagName("head")[0],o=document.createElement("script");o.async=!0,o.type="text/javascript",o.charset="utf-8",o.src=e,a("loading %s",e),o.onload=o.onreadystatechange=o.onerror=function(i){var s="load"===i.type||/^(loaded|complete)$/.test(o.readyState),c="error"===i.type;(s||c)&&(r.removeChild(o),s?t():n({type:i.type,request:e}),a("load %s "+i.type,e))},r.appendChild(o)})}function o(e,t,n,o){return new i.Promise(function(n){return s[e]?void n(s[e]):c[e]?(console.warn(e+".js已经在加载中..."),void c[e].then(function(){n(s[e])})):void(c[e]=r(t).then(function(){delete c[e],n(s[e])}))}).then(function(e){return e&&e(n,o)})["catch"](function(t){return console.error("Load Module:"+e+" Error",t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.$script=r,t.$load=o;var i=n(96),a=n(5)("cy:loader"),s={},c={};window.defineCytronModule=function(e,t){s[e]=t}},,,,,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=navigator.userAgent.toLowerCase(),r=/android|ios|iphone|ipad|ipod|mobile|blackberry/,o=n.indexOf("msie")!==-1&&parseInt(n.split("msie")[1]);t.notSupport=o&&o<10||/blackberry/.test(n),t.isModern=!o||o>10,t.isMobile=r.test(n)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){o=!0,i=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=n(82),u=o(c),l=n(6),f=r(l),d=n(77),p=n(198),h=o(p),y=n(174),v=r(y),m=n(14)("cy:api"),g={prefix:f["default"].apiAddress,meAddress:f["default"].meAddress,vaAddress:f["default"].vaAddress,authAddress:f["default"].authAddress},b=function(e){return window.btoa(unescape(encodeURIComponent(e)))},_=function(e){var t=/^(http:)|(https:)/.test(e);return t?e:g.prefix+e},w=function(e){var t=v["default"].getToken(),n=v["default"].getAppStoreToken(),r=e||{Appkey:b(v["default"].getAppkey()),Authorization:t?"Bearer "+t:"","Auth-App-Store":n||"",Identity:v["default"].getIdentity(),"Content-Type":"application/json"};return{headers:r}},O=function(e,t){var n=u.find(Object.keys(e),function(e){return t.indexOf(e)!==-1});return e[n]},T=function(e,t){if(t=t||"",403===e){var n=i({},"no power ak","请确保您的appkey正确且被加入白名单");return O(n,t)||"您的操作没有权限哦~"}return 401===e?"请先登录您的账号~":404===e?"抱歉，您访问的接口找不到了~":t||"抱歉，服务器发生未知错误"},k=["jsonp","get","post","delete"].reduce(function(e,t){return e[t]=function(e,n,r){return h["$"+t](_(e),n,w(r)).then(function(e){var t=e&&e.data,n=t&&t.status||200,r=t&&t.msg||t&&t.data||t;return 200!==n?Promise.reject({message:T(n,t.msg),status:n,data:r}):u.assign({},e,{data:r})},function(e){var t={message:T(e.status,e.message),data:e.data,status:e.status};return Promise.reject(t)})},e},{});t["default"]={setup:function(e){var t=e.meAddress,n=e.apiAddress,r=e.vaAddress,o=e.authAddress;return n&&(g.prefix=n),t&&(g.meAddress=t),r&&(g.vaAddress=r),o&&(g.authAddress=o),Promise.all([k.jsonp(g.meAddress+"/jsonp/getUid").then(function(e){return e.data}),k.jsonp(g.authAddress+"/jsonp/getCookie.js").then(function(e){return e.data||{}})]).then(function(e){var t=s(e,2),n=t[0],r=t[1];return v["default"].setIdentity(n),r.token?(v["default"].setToken(r.token),k.get(g.prefix+"/user/currentUser").then(function(e){var t=e.data;v["default"].setPower(t.power),v["default"].setIp(t.ip),v["default"].setRefer(t.refer),v["default"].setUserAgent(t.userAgent)})):r})["catch"](function(){return Promise.resolve({})})},getVideoConfigs:function(e){var t={local:1,title:document.title,url:b(e)};return k.post("/video",t).then(function(e){var t=e.data;return v["default"].setVideoId(t.videoId),v["default"].setAppStoreToken(t.appStoreToken),v["default"].setChannel(t.channel),v["default"].setBrand(t.brand),v["default"].setProject(t.project),t})["catch"](function(e){return console.error("GET api/video 接口获取Video++视频信息失败，"+e.message),Promise.resolve({})})},getVideoData:function(e){var t=(0,d.isEmpty)(e),n=t?{v:v["default"].getVideoId()}:null,r=e||"/flow";return k.get(r,n,!t&&{}).then(function(e){return e.data})["catch"](function(){return Promise.resolve({})})},getGlobalData:function(){var e={project:v["default"].getProject(),channel:v["default"].getChannel()};return k.get("/flow/global",e).then(function(e){return e.data})["catch"](function(){return Promise.resolve({})})},mqttNotify:function(){var e={videoId:v["default"].getVideoId(),project:v["default"].getProject(),clientId:v["default"].getClientId(),channel:v["default"].getChannel()};return k.get("/mqtt",e).then(function(e){return e.data})},monitor:function(e){var t=e.name,n=e.type,r=e.url,o=new Image(1,1);o.onload=o.onerror=function(){m("monitor "+n+":"+t+"("+r+")")},o.src=r},track:function(e){if(v["default"].getDPI()){var t=e&&e.cat||{},n=e&&e.s||f["default"].serviceType.videoOS,r=n.alias+":"+t.alias+"("+n.value+":"+t.value+")";if(e=a({cat:"",s:"",ver:1,n:Math.floor(1e8*Math.random()),v:v["default"].getVideoId()||"",ch:v["default"].getChannel()||"",proj:v["default"].getProject()||"",br:v["default"].getBrand()||"",rs:v["default"].getDPI(),c:v["default"].getIdentity()||"",lang:navigator.language||navigator.userLanguage,dr:0,x:0,y:0},e,{cat:t.value,s:n.value}),"local"===f["default"].version&&f["default"].debug)return void m("track "+r,e);var o=h.appendQuery(g.vaAddress+"/track/va.gif",e),i=new Image(1,1);i.onload=i.onerror=function(){m("track "+r)},i.src=o}},ajax:k}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){function n(){f&&u&&(f=!1,u.length?l=u.concat(l):d=-1,l.length&&r())}function r(){if(!f){var e=a(n);f=!0;for(var t=l.length;t;){for(u=l,l=[];++d<t;)u&&u[d].run();d=-1,t=l.length}u=null,f=!1,s(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var a,s,c=e.exports={};!function(){try{a=setTimeout}catch(e){a=function(){throw new Error("setTimeout is not defined")}}try{s=clearTimeout}catch(e){s=function(){throw new Error("clearTimeout is not defined")}}}();var u,l=[],f=!1,d=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new o(e,t)),1!==l.length||f||a(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=i,c.addListener=i,c.once=i,c.off=i,c.removeListener=i,c.removeAllListeners=i,c.emit=i,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.toast=t.scene=void 0;var o=n(186),i=r(o),a=n(187),s=r(a);t.scene=i,t.toast=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),i=r(o),a=i["default"].debug?"cytron-platform.debug":"cytron-platform.prod",s={};n(5)("cy:session"),t["default"]={setToken:function(e){s.token=e},setAppkey:function(e){s.appkey=e},setVideoId:function(e){s.videoId=e},setPower:function(e){s.power=e},setAppStoreToken:function(e){s.appStoreToken=e},setProject:function(e){s.project=e},setChannel:function(e){s.channel=e},setBrand:function(e){s.brand=e},setIp:function(e){s.ip=e},setUserAgent:function(e){s.userAgent=e},setRefer:function(e){s.refer=e},setDPI:function(e){var t=e.width,n=e.height,r=Math.round(t)+"x"+Math.round(n);s.dpi=r},setIdentity:function(e){s.identity=e},getToken:function(){return s.token},getVideoId:function(){return s.videoId},getAppkey:function(){return s.appkey},getIdentity:function(){return s.identity||""},getClientId:function(){return"CID_H5@@@"+s.identity},getEditable:function(){var e=s.power||"000000";return"1"===e.charAt(5)||"1"===e.charAt(1)},getAppStoreToken:function(){return s.appStoreToken},getProject:function(){return s.project},getChannel:function(){return s.channel},getBrand:function(){return s.brand},getIp:function(){return s.ip},getUserAgent:function(){return s.userAgent},getRefer:function(){return s.refer},getDPI:function(){return s.dpi},storage:{get:function(e){var t=a+"."+e,n=window.localStorage.getItem(t);return n?JSON.parse(n):n},set:function(e,t){var n=a+"."+e;return window.localStorage.setItem(n,JSON.stringify(t))},remove:function(e){var t=a+"."+e;return window.localStorage.removeItem(t)},clear:function(){window.localStorage.clear()}}}},,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=c(["\n  .toastWrapper {\n    display: block;\n    text-align: center;\n    pointer-events: auto;\n  }\n  .toastRoot {\n    color: white;\n    display: inline-block;\n    cursor: pointer;\n    width: auto;\n    padding: 8px 10px;\n    margin: 5px;\n    line-height: 20px;\n    text-align: left;\n    margin: 5px;\n    font-size: 13px;\n    font-weight: normal;\n    border-radius: 3px;\n    box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2), 0 1px 4px rgba(0, 0, 0, 0.3);\n    -webkit-animation: toast-enter ","ms ease-in;\n            animation: toast-enter ","ms ease-in;\n    -webkit-animation-fill-mode: both;\n            animation-fill-mode: both;\n  }\n  .enter {\n    -webkit-animation: none;\n            animation: none;\n  }\n  .leave {\n    -webkit-animation: toast-leave ","ms ease-out;\n            animation: toast-leave ","ms ease-out;\n    -webkit-animation-fill-mode: both;\n            animation-fill-mode: both;\n  }\n  .success {\n    background-color: #71b570;\n  }\n  .warn {\n    background-color: #f89406;\n  }\n  .error {\n    background-color: #f26969;\n  }\n  .info {\n    background-color: #7986cb;\n  }\n  @-webkit-keyframes toast-enter {\n    0% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px) scale(0.2);\n              transform: translateY(-100px) scale(0.2);\n    }\n    100% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n  }\n  @keyframes toast-enter {\n    0% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px) scale(0.2);\n              transform: translateY(-100px) scale(0.2);\n    }\n    100% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n  }\n  @-webkit-keyframes toast-leave {\n    0% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n    100% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px);\n              transform: translateY(-100px);\n    }\n  }\n  @keyframes toast-leave {\n    0% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n    100% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px);\n              transform: translateY(-100px);\n    }\n  }\n"],["\n  .toastWrapper {\n    display: block;\n    text-align: center;\n    pointer-events: auto;\n  }\n  .toastRoot {\n    color: white;\n    display: inline-block;\n    cursor: pointer;\n    width: auto;\n    padding: 8px 10px;\n    margin: 5px;\n    line-height: 20px;\n    text-align: left;\n    margin: 5px;\n    font-size: 13px;\n    font-weight: normal;\n    border-radius: 3px;\n    box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2), 0 1px 4px rgba(0, 0, 0, 0.3);\n    -webkit-animation: toast-enter ","ms ease-in;\n            animation: toast-enter ","ms ease-in;\n    -webkit-animation-fill-mode: both;\n            animation-fill-mode: both;\n  }\n  .enter {\n    -webkit-animation: none;\n            animation: none;\n  }\n  .leave {\n    -webkit-animation: toast-leave ","ms ease-out;\n            animation: toast-leave ","ms ease-out;\n    -webkit-animation-fill-mode: both;\n            animation-fill-mode: both;\n  }\n  .success {\n    background-color: #71b570;\n  }\n  .warn {\n    background-color: #f89406;\n  }\n  .error {\n    background-color: #f26969;\n  }\n  .info {\n    background-color: #7986cb;\n  }\n  @-webkit-keyframes toast-enter {\n    0% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px) scale(0.2);\n              transform: translateY(-100px) scale(0.2);\n    }\n    100% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n  }\n  @keyframes toast-enter {\n    0% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px) scale(0.2);\n              transform: translateY(-100px) scale(0.2);\n    }\n    100% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n  }\n  @-webkit-keyframes toast-leave {\n    0% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n    100% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px);\n              transform: translateY(-100px);\n    }\n  }\n  @keyframes toast-leave {\n    0% {\n      opacity: 1;\n      -webkit-transform: translateY(0) scale(1);\n              transform: translateY(0) scale(1);\n    }\n    100% {\n      opacity: 0;\n      -webkit-transform: translateY(-100px);\n              transform: translateY(-100px);\n    }\n  }\n"]),d=n(1),p=n(2),h=r(p),y=n(77),v=n(3),m={timeout:300},g=(0,h["default"])(f,m.timeout,m.timeout,m.timeout,m.timeout),b=(0,v.pure)(u=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.onRemoveToast=function(){clearTimeout(r.timeoutId),r.setState({leave:!0}),setTimeout(function(){var e=r.props.id;r.context.actions.toast.remove(e).dispatch()},m.timeout)},r.state={},r}return s(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){return e.setState({enter:!0})},m.timeout);var t=this.props.timeout;(0,y.isNumeric)(t)&&(this.timeoutId=setTimeout(this.onRemoveToast,t))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(e,t){var n,r=e.type,i=e.message,a=(0,v.cx)(g.toastRoot,g[r],(n={},o(n,g.leave,t.leave),o(n,g.enter,!t.leave&&t.enter),n));return(0,d.h)("div",{className:g.toastWrapper},(0,d.h)("div",{className:a,onClick:this.onRemoveToast},i))}}]),t}(d.Component))||u;t["default"]=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function c(e,t){var n=E[e.instanceId];n.rootInstance=(0,h.render)((0,h.h)(n.Root,{key:e.instanceId,plugins:t}),e.$container,n.rootInstance)}function u(e,t){E[e.instanceId]={Root:I(e)},c(e,t)}function l(e){var t=E[e.instanceId];t&&((0,h.render)((0,h.h)("span",{id:e.rootId}),e.$container,t.rootInstance),setTimeout(function(){var t=document.getElementById(e.rootId);t.parentElement&&t.parentElement.removeChild(t),E[e.instanceId]=void 0}))}Object.defineProperty(t,"__esModule",{value:!0}),t.RootComponent=void 0;var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),p=s(["\n  .toasts {\n    position: absolute;\n    left: 50%;\n    top: 10px;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%);\n    z-index: 9999999;\n    text-align: center;\n  }\n"],["\n  .toasts {\n    position: absolute;\n    left: 50%;\n    top: 10px;\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%);\n    z-index: 9999999;\n    text-align: center;\n  }\n"]);
t.refresh=c,t.start=u,t.destroy=l;var h=n(1),y=n(2),v=r(y),m=n(77),g=n(6),b=r(g),_=n(103),w=r(_),O=n(184),T=r(O),k=(n(5)("cy:renderer"),(0,v["default"])(p)),I=t.RootComponent=function(e){return function(t){function n(t){o(this,n);var r=i(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return r.onActiveHiddenNodes=function(){var t=function(){clearTimeout(r.autoHiddenTimer),r.autoHiddenTimer=setTimeout(function(){r.autoHiddenTimer=void 0,e.actions.scene.hideHidden().dispatch()},3e3)};r.autoHiddenTimer||e.actions.scene.showHidden().dispatch(),t()},r.onResize=(0,m.debounce)(300)(function(){var t=e.$container.getBoundingClientRect();e.session.setDPI(t),r.forceUpdate()}),r.getFlowNodes=function(t){var n=e.runner.getFlow(t);return n?n.nodes:[]},r.state={},r}return a(n,t),d(n,[{key:"getChildContext",value:function(){return{config:e.config,player:e.player,runner:e.runner,actions:e.actions,session:e.session,mqttClient:e.mqttClient,rootElement:e.$container,ajax:w["default"].ajax,track:w["default"].track,monitor:w["default"].monitor,getFlowNodes:this.getFlowNodes}}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize),e.$container.addEventListener("mousemove",this.onActiveHiddenNodes)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.autoHiddenTimer),window.removeEventListener("resize",this.onResize),e.$container.removeEventListener("mousemove",this.onActiveHiddenNodes)}},{key:"renderNodes",value:function(t,n){var r=t.scene;if(r.activePlugin)return null;var o=r.hookState||{};return e.runner.getDisplayingNodes().filter(function(e){return!e.nodeData.autoHidden||r.isShowHidden}).map(function(t){var i=e.runner.getModule(t._nodeKey),a=t._state;return(0,h.h)(i,{key:n+"_"+t._nodeKey+"_"+t._id,style:t.initedStyle,isPlaying:r.isPlaying,trackTime:(0,m.isEmpty)(t.tracks)?null:r.currentTime,canDisplay:!(t.isHidden||a.hideInLayerMode&&o.layerMode),node:t})})}},{key:"renderPlugins",value:function(t){var n=this,r=this.props.plugins||{},o=t.scene,i=o.activePlugin,a=o.hookState,s=a||{},c=s.layerMode,u=e.runner.setActivePlugin;return Object.keys(r).map(function(e){var o=r[e],a=i&&i!==e||c;if(!o||a)return null;var s="PLUGIN_"+e;return n[s]||(n[s]={onActivate:u.bind(n,e),onInactivate:u.bind(n,null)}),(0,h.h)(r[e],f({key:s},n[s],{state:t[e]}))})}},{key:"renderBackdrop",value:function(t){var n=t.scene,r=n.hookState||{},o=r.backdrop,i=r.layerMode,a=o,s={pointerEvents:"auto",backgroundColor:i?"rgba(0,0,0,0.3)":"rgba(0,0,0,0)",zIndex:0};return a?(0,h.h)("div",{id:"__CYTRON_BACKDROP__"+e.instanceId,className:b["default"].name,style:s}):null}},{key:"renderToasts",value:function(t){var n=t.toasts||{};return 0===Object.keys(n).length?null:(0,h.h)("div",{id:"__CYTRON_TOASTS__"+e.instanceId,key:"toasts-group",className:k.toasts},Object.keys(n).map(function(e){var t=n[e];return(0,h.h)(T["default"],f({key:"toast_"+e},t))}))}},{key:"render",value:function(){var t=e.runner.getStore().getState(),n=e.session.getDPI();return(0,h.h)("div",{id:e.rootId,className:b["default"].name},this.renderBackdrop(t),this.renderNodes(t,n),this.renderPlugins(t,n),this.renderToasts(t,n))}}]),n}(h.Component)},E={Root:void 0,rootInstance:void 0}},function(e,t){"use strict";function n(){return{type:"PLAY",payload:null}}function r(){return{type:"PAUSE",payload:null}}function o(e){return{type:"UPDATE_TIME",meta:{ignoreLog:!0},payload:Math.max(0,e)}}function i(e){return o(e)}function a(){return{type:"STOP",payload:null}}function s(){return{meta:{ignoreLog:!0},type:"SHOW_HIDDEN"}}function c(){return{meta:{ignoreLog:!0},type:"HIDE_HIDDEN"}}function u(e,t,n){return{type:"TRIGGER_NEXT",payload:{currentNode:e,slotId:t,portData:n}}}function l(e){return{type:"SET_ACTIVE_PLUGIN",payload:e}}function f(e){return{type:"REFRESH",payload:e}}function d(){return{type:"DESTROY",payload:null}}Object.defineProperty(t,"__esModule",{value:!0}),t.play=n,t.pause=r,t.updateTime=o,t.setTime=i,t.stop=a,t.showHidden=s,t.hideHidden=c,t.triggerNext=u,t.setActivePlugin=l,t.refresh=f,t.destroy=d},function(e,t){"use strict";function n(e){return{type:"SHOW_TOAST",payload:{type:"error",option:e},meta:{ignoreLog:!0}}}function r(e){return{type:"SHOW_TOAST",payload:{type:"warn",option:e},meta:{ignoreLog:!0}}}function o(e){return{type:"SHOW_TOAST",payload:{type:"success",option:e},meta:{ignoreLog:!0}}}function i(e){return{type:"SHOW_TOAST",payload:{type:"info",option:e},meta:{ignoreLog:!0}}}function a(e){return{type:"REMOVE_TOAST",payload:{id:e},meta:{ignoreLog:!0}}}Object.defineProperty(t,"__esModule",{value:!0}),t.error=n,t.warn=r,t.success=o,t.info=i,t.remove=a},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e,t){function n(e){return(0,i.validFlowMap)(e)?(e.nodes.forEach(function(t){t._nodeId=e._id+"_"+t.nodeId,t._nodeKey=t.nodeType+"."+(t.themeName||"default")}),void(u[e._id]=e)):void console.warn("格式不合法的FlowMap",e)}function r(e){if(e&&e.web){if(!(0,i.validFlowData)(e))return void console.warn("格式不合法的FlowData",e);var t=u[e.flowMapId];if(!(0,i.validFlowMap)(t))return void console.error("flows:"+e._id+" 的 flowMapId:"+e.flowMapId+" 未能匹配到合法的flowMap");e.nodes.forEach(function(n,r){var a=s.find(t.nodes,function(e){return e.nodeId===n.nodeId});(0,i.assert)(a,"flow:"+e._id+" node: "+n._id+" 未能在flowMap中匹配到nodeId为 "+n.nodeId+" 的节点"),n._mongoId=n._id,n._id=e._id+"_"+r,n._nodeId=e.flowMapId+"_"+n.nodeId,n._flowId=e._id,n._flowMapId=e.flowMapId,n._resourceId=e.resourceId,n._nodeKey=a._nodeKey,n.tracks&&(n.tracks=n.tracks.sort(function(e,t){return e.time-t.time})),n._state={hideInLayerMode:a.hideInLayerMode,lifeLimit:a.lifeLimit,hookState:a.hookState,flowMapNode:a};var c=s.find(a.portOut,function(e){return"LIVE_TIME"===e.portType});if(c)n.liveTime=o(n,"portOutPayload",c.portId),n.isLive=!0;else{var u=s.find(a.portIn,function(e){return"TIME"===e.portType}),l=s.find(a.portOut,function(e){return"TIME"===e.portType});u&&(n.inTime=o(n,"portInPayload",u.portId)),l&&(n.outTime=o(n,"portOutPayload",l.portId))}n.isTag=(0,i.isNumeric)(n.inTime)||(0,i.isNumeric)(n.liveTime),f[n._id]=n}),l[e._id]=e}}function o(e,t,n){return e[t]?e[t][n]:(console.error("数据有误：node."+t+" 缺失, _id: "+e._id+", flowId: "+e._flowId),null)}function a(e){var t=e._state,n=t.lifeCount=(t.lifeCount||0)+1,r=t.lifeLimit;return!r||n<r}var u={},l={},f={};e&&e.forEach(n),t&&t.forEach(r),c("initedFlowMaps:",u),c("initedNodes",f);var d={getNextNode:function(e,t){var n=e._state,r=n.flowMapNode,o=s.find(r.portOut,function(e){return e.slotId===t}),i="triggerCount_"+t,c=n[i]=(n[i]||0)+1,f=o.triggerLimit;if(f&&c>=f&&(n.lifeLimit=1,e.isDirty=!0),!o.toPort)return e.isDirty=!0,e.fromNode&&(e.fromNode.isHidden=void 0),null;var d=u[e._flowMapId],p=s.find(d.nodes,function(e){return!!e.portIn&&s.find(e.portIn,function(e){return e.portId===o.toPort&&e.portType===o.portType})}),h=l[e._flowId],y=s.find(h.nodes,function(e){return e._nodeId===p._nodeId});return a(y)?(o.showingWithPortOver?e.isHidden=!0:e.isDirty=!0,y.fromNode=e,y.isLive=!0,y.isDirty=void 0,y):null},getFlowMap:function(e){var t=u[e];return t},getNodes:function(){return Object.keys(f).map(function(e){return f[e]})},addFlowMap:n,addFlow:r,removeFlow:function(e){var t=l[e];return t?(t.nodes.forEach(function(e){delete f[e._id]}),void delete l[e]):void c("删除失败，没有找到对应的flowId: "+e)},getFlow:function(e){return l[e]},getNewActiveNodes:function(e,t){var n=function(e){e.activeTime=void 0,e.isLive=void 0,e.isDirty=void 0,e.liveTime=void 0},r=Date.now(),o=Object.keys(f).map(function(e){return f[e]}).filter(function(o){var c=(0,i.isNumeric)(o.inTime)&&t>=o.inTime-100,u=(0,i.isNumeric)(o.outTime)&&t>o.outTime,l=!c||u,f=o.isLive,d=o.isDirty;if(!f&&l)return n(o),!1;if(f&&d)return n(o),!1;if(f&&(0,i.isNumeric)(o.liveTime)&&(0,i.isNumeric)(o.activeTime)){var p=r-o.activeTime>=o.liveTime;if(p)return n(o),!1}var h=!s.find(e,function(e){return e._id===o._id});return h&&!a(o)?(n(o),!1):(h&&(o.activeTime=r),!0)});return o}};return d}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(77),a=n(82),s=r(a),c=n(5)("cy:flow")},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){function t(){S("=====> runner bootstrap"),N.dispatch(_.scene.refresh("TIME_FLOW")),k.start(e,C),T=N.subscribe(function(){k.refresh(e,C)})}function n(){S("=====> runner destroy"),N.dispatch(_.scene.destroy()),T&&T(),k.destroy(e)}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];return Object.keys(j).reduce(function(r,o){var i=n.payload,s=n.type,c=(j[o]||{})[s],u=t[o]||P[o],l=(0,f.isFunction)(c)&&c(u,i,e,n);return r[o]=l?a({},l):u,r},P)}function o(){return N}function i(){var e=N.getState().scene.activeNodes,t=void 0===e?[]:e;return t.filter(function(e){return!e.isDirty})}function s(e){N.dispatchAync(_.scene.setActivePlugin(e))}function u(t){return new E.Promise(function(n,r){if(!t||!t.length)return n();var o=t.map(function(t){var n=c["default"].publicUrl+t+".js";return(0,I.$load)(t,n,e.$container,e.config)});return E.Promise.all(o).then(function(t){t.forEach(function(e){var t=e.name,n=e.reducer,r=e.defaultState,o=e.component;S("register plugin:",t);var i="plugin_"+t;j[i]=n,P[i]=r,C[i]=o}),e.$style=(0,d.injectCsjs)(e.$container,e.$style),n()},r)}).then(function(t){return e.actions.scene.refresh().dispatch(),t})}function p(t){return new E.Promise(function(n,r){if(!t||!t.length)return n();var o=t.reduce(function(t,n){return e.flowManager.addFlowMap(n),n.nodes.forEach(function(e){var n=y(e._nodeKey)||e.ignore,r="module."+e._nodeKey;n||t.indexOf(r)!==-1||t.push(r)}),t},[]);if(!o.length)return n();var i=o.map(function(t){var n=c["default"].publicUrl+t+".js";return(0,I.$load)(t,n,e.$container,e.config)});return E.Promise.all(i).then(function(t){t.forEach(function(e){var t=e.nodeType,n=e.theme,r=e.component,o=t+"."+n;M[o]=r}),e.$style=(0,d.injectCsjs)(e.$container,e.$style),n()},r)}).then(function(t){return e.actions.scene.refresh().dispatch(),t})}function y(e){return M[e]}function m(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TIME_FLOW";t&&t.length&&(t.forEach(e.flowManager.addFlow),e.actions.scene.refresh(n).dispatchAync())}function b(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TIME_FLOW";t&&(e.flowManager.removeFlow(t),e.actions.scene.refresh(n).dispatchAync())}function w(t){return t?e.flowManager.getFlow(t):null}var T=null,x={container:null,root:null},M={},C={},P={scene:{currentTime:0,activeNodes:[],hookState:{backdrop:!1,layerMode:!1,playerPause:!1,playerBlur:!1},isShowHidden:!1,isPlaying:!1,activePlugin:null},toasts:{}},j={scene:v["default"],toasts:g["default"]},N=(0,h["default"])(r,O);return{bootstrap:t,destroy:n,getStore:o,getDisplayingNodes:i,registerPlugins:u,setActivePlugin:s,registerModules:p,getModule:y,registerFlows:m,removeFlow:b,getFlow:w,onPlay:function(){N.dispatch(_.scene.play())},onPause:function(){N.dispatch(_.scene.pause())},onStop:function(){N.dispatch(_.scene.stop())},onSetTime:function(e){N.dispatch(_.scene.setTime(e))},onFullscreen:function(){var t={zIndex:2147483647},n={maxHeight:"none",maxWidth:"none",height:"100%",width:"100%",margin:0,top:0,left:0,right:0,bottom:0},r=document.getElementById(e.rootId);r&&(x.root=Object.keys(t).reduce(function(e,t){return e[t]=r.style[t],e},{}),x.container=Object.keys(n).reduce(function(t,n){return t[n]=e.$container.style[n],t},{}),l.assign(r.style,t),l.assign(e.$container.style,n))},onExitFullscreen:function(){var t=document.getElementById(e.rootId);l.assign(t.style,x.root),l.assign(e.$container.style,x.container),x.root=x.container=null}}}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t["default"]=i;var s=n(6),c=o(s),u=n(82),l=r(u),f=n(77),d=n(2),p=n(195),h=o(p),y=n(193),v=o(y),m=n(194),g=o(m),b=n(173),_=r(b),w=n(190),O=r(w),T=n(185),k=r(T),I=n(97),E=n(96),S=n(5)("cy:runner")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(192);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var o=n(191);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;var o=n(6),i=r(o),a=n(77),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return"color: "+e+"; font-weight: "+t+";"},c=t.logger=function(e){return function(t){return function(n){if(!n)return null;if(!i["default"].debug||n.meta&&n.meta.ignoreLog)return t(n);var r=(new Date).toTimeString().split(" ")[0];(0,a.groupStartLog)(n.type);var o=e.getState();console.log("%c prev state",s("#9E9E9E",800),(0,a.clone)(o)),console.log("%c action("+r+")",s("#03A9F4"),n);var c=t(n),u=e.getState();return console.log("%c next state",s("#4CAF50",800),(0,a.clone)(u)),(0,a.groupEndLog)(n.type),c}}};t["default"]=c},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.readyStatePromise=t.vanillaPromise=t.requestPromise=void 0;var o=n(96),i=n(82),a=r(i);t.requestPromise=function(e){return function(t){return function(n){return n.payload&&"function"==typeof n.payload.then?o.Promise.resolve(n.payload).then(function(t){return e.dispatch({type:n.type+"_SUCCESS",meta:n.meta,payload:t}),"function"==typeof n.successCb&&n.successCb(t),t},function(t){return e.dispatch({type:n.type+"_FAIL",payload:t}),"function"==typeof n.failCb&&n.failCb(t),o.Promise.reject(t)}):t(n)}}},t.vanillaPromise=function(e){return function(t){return function(n){return"function"!=typeof n.then?t(n):o.Promise.resolve(n).then(e.dispatch)}}},t.readyStatePromise=function(e){return function(e){return function(t){function n(e,n){var r=a.assign({},t,{ready:e},n);return delete r.promise,r}return t.promise?(e(n(!1)),t.promise.then(function(t){return e(n(!0,{result:t}))},function(t){return e(n(!0,{error:t}))})):e(t)}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function s(e){e.__videoTimer&&(clearInterval(e.__videoTimer),e.__videoTimer=null)}function c(e,t){var n=1e3/t.config.fps;s(t),"normal"===t.mode&&(t.__videoTimer=setInterval(function(){var n=t.player.getTime();e.currentTime!==n&&t.actions.scene.updateTime(n).dispatch()},n))}function u(e,t){l(t);var n=Date.now(),r=e.activeNodes.filter(function(e){return e.isLive&&(0,y.isNumeric)(e.liveTime)&&(0,y.isNumeric)(e.activeTime)}).map(function(e){return e.activeTime+e.liveTime-n});r.length&&(t.__liveTimer=setTimeout(function(){t.actions.scene.refresh("LIVE_FLOW").dispatchAync()},Math.min.apply(Math,a(r))))}function l(e){e.__liveTimer&&(clearInterval(e.__liveTimer),e.__liveTimer=null)}function f(e,t){var n=e.hookState,r=e.activeNodes.filter(function(e){return!e.isDirty}).reduce(function(e,t){var n=t._state.hookState||{},r=Object.keys(n).reduce(function(e,t){return n[t]&&(e[t]=n[t]),e},{});return h.assign(e,r)},{backdrop:!1,layerMode:!1,playerPause:!1,playerBlur:!1});!e.isPlaying&&r.playerPause&&(r.playerPause=!1),r.playerPause!==n.playerPause&&(r.playerPause?setTimeout(t.player.pause):setTimeout(t.player.play)),r.playerBlur!==n.playerBlur&&(r.playerBlur?t.player.blur(22):t.player.blur(0)),e.hookState=r}Object.defineProperty(t,"__esModule",{value:!0});var d,p=n(82),h=o(p),y=n(77),v=n(6),m=r(v),g=n(103),b=r(g),_=n(5)("cy:rd.scene"),w=m["default"].trackCategory,O=w.videoPlay,T=w.videoPause,k=w.videoDrag,I=w.nodeJump,E=(d={},i(d,"PLAY",function(e,t,n){return c(e,n),e.isPlaying||b["default"].track({cat:O}),e.isPlaying=!0,e}),i(d,"PAUSE",function(e,t,n){return s(n),e.isPlaying&&b["default"].track({cat:T}),e.isPlaying=!1,e}),i(d,"UPDATE_TIME",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments[2],r=n.player.getTotalTime();if(r>1e3&&t>=r)return _("reach the end of timeline,should switch to next scenes or stop"),s(n),e.currentTime=r,e.isPlaying=!1,e;var o=t-e.currentTime;Math.abs(o)>3e3&&b["default"].track({cat:k,x:Math.round(e.currentTime),y:Math.round(t)}),e.currentTime=t;var i=n.flowManager.getNewActiveNodes(e.activeNodes,e.currentTime);return e.activeNodes=i,f(e,n),e}),i(d,"REFRESH",function(e,t,n){if(!t)return e;if(e.activeNodes=n.flowManager.getNewActiveNodes(e.activeNodes,e.currentTime),u(e,n),f(e,n),"TIME_FLOW"===t&&n.player.insertDots){var r=n.flowManager.getNodes().filter(function(e){return(0,y.isNumeric)(e.inTime)}).map(function(e){return{id:e._id,intro:e.nodeData.title||"",time:e.inTime}});n.player.insertDots(r)}return e}),i(d,"STOP",function(e,t,n){return s(n),e.currentTime=0,e.isPlaying=!1,e}),i(d,"DESTROY",function(e,t,n){return s(n),l(n),e}),i(d,"WAIT",function(e,t,n){return s(n),e}),i(d,"SHOW_HIDDEN",function(e){return e.isShowHidden=!0,e}),i(d,"HIDE_HIDDEN",function(e){return e.isShowHidden=!1,e}),i(d,"TRIGGER_NEXT",function(e,t,n){var r=t.currentNode,o=t.slotId,i=t.portData,a=n.flowManager.getNextNode(r,o);return a&&(a.portInData||(a.portInData=[]),void 0!==i&&(a.portInData=a.portInData.filter(function(e){return e!==i}).concat([i])),b["default"].track({cat:I,x:r._mongoId,y:a._mongoId})),e.activeNodes=n.flowManager.getNewActiveNodes(e.activeNodes,e.currentTime),f(e,n),e}),i(d,"SET_ACTIVE_PLUGIN",function(e,t){return e.activePlugin=t,e}),d);t["default"]=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77);t["default"]={SHOW_TOAST:function(e,t){var n=t.type,o=t.option,i="string"==typeof o?{message:o}:o,a=i.id,s=void 0===a?(0,r.uid)():a,c=i.message,u=i.timeout,l=void 0===u?3e3:u;return e[s]={id:s,type:n,message:c,timeout:l},e},REMOVE_TOAST:function(e,t){var n=t.id;return delete e[n],e}}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){function n(e){(0,i.assert)("function"==typeof e,"subscribe: listener must be an function"),s.push(e);var t=!0;return function(){if(t){t=!1;var n=s.indexOf(e);s.splice(n,1)}}}function o(t){(0,i.assert)((0,i.isPlainObject)(t),"action must be an plain object, use custom middleware for async actions"),(0,i.assert)("undefined"!=typeof t.type,'action must have an "type" property, have you misspelled a constant?'),(0,i.assert)(!u,"reducer may not dispatch actions");try{u=!0,c=e(c,t)}finally{u=!1}return s.slice().forEach(function(e){return e(c)}),t}(0,i.assert)("function"==typeof e,"reducer must be an function");var s=[],c={},u=!1;o({type:a.INIT});var l={getState:function(){return c},dispatch:o},f=function(e){return"function"==typeof e.getValue?e.getValue():e},d=Object.keys(t).map(function(e){return t[e](l)}),p=function(e){e=f(e),i.compose.apply(void 0,r(d))(o)(e)},h=function(e){return setTimeout(function(){return p(e)})},y=function v(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return"function"==typeof r?t[n]=function(){var e=r.apply(void 0,arguments);return{getValue:function(){return e},dispatch:function(){return p(e)},dispatchAync:function(){return h(e)}}}:t[n]=v(r),t},{})};return{getState:l.getState,dispatch:p,dispatchAync:h,subscribe:n,bindActions:y}}Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,t["default"]=o;var i=n(77),a=t.ActionTypes={INIT:"@cytron-platform/INIT"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var i=n(77),a=n(197),s=r(a),c=n(292),u=n(14)("cy:mqtt"),l="Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&navigator.appVersion.indexOf("Trident")>-1||navigator.userAgent.indexOf("Edge/")>-1,f=function d(e){var t=this;o(this,d);var n=e.parent,r=e.clientId,a=e.videoId,f=e.channelId,p=e.projectId,h="beijing-mqtt.ons.aliyun.com",y=["cytron/p2p","cytron/site","cytron/"+a,"cytron/channels/"+f,"cytron/project/"+p],v={},m=10,g=!1,b=0,_=null,w=e.onConnect,O=l?new s["default"](n,h,r):new c.MQTT.Client(h,80,r),T={userName:"CSwtMsBf6OXprzjS",password:"+NzaZi/0UHxnB7mNWe/wbT1gl6Q=",onSuccess:function(){u("onSuccess",O.isConnected()),y.forEach(O.subscribe),(0,i.isFunction)(w)&&(w(),w=null)}};O.onConnectionLost=function(e){_&&(clearTimeout(_),_=null),g||(u("onConnectionLost"),b<=m?_=setTimeout(function(){return t.connect(!0)},3e3):u("Reconnect Failed",e))},O.onMessageArrived=function(e){try{!function(){var t=JSON.parse(e.payloadString),n=t.msg,r=t.type;u("onMessageArrived",r,n),Object.keys(v[r]||{}).forEach(function(e){var t=v[r][e];(0,i.isFunction)(t)&&t(n)})}()}catch(t){u(t)}},this.connect=function(e){g=!1,clearTimeout(_),O.isConnected()||(e?(b+=1,u("Reconnecting... "+b+" time",T)):(b=0,u("Connecting...",T)),O.connect(T))},this.disconnect=function(){g=!0,y.forEach(O.unsubscribe),O.disconnect()},this.addMsgListener=function(e,t){v[e]||(v[e]={}),v[e][t]=t},this.removeMsgListener=function(e,t){v[e]||(v[e]={}),delete v[e][t]},this.connect()};t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var i=n(6),a=r(i),s=(n(14)("cy:swf-mqtt"),'\n  <object\n    id="cytron-mqtt-swf"\n    data="'+a["default"].assertsUrl+'/mqtt.swf"\n    type="application/x-shockwave-flash"\n    style="width:0; height:0;"\n  >\n    <param name="allowScriptAccess" value="always" />\n    <param name="allowInsecureDomain" value="*" />\n    <param name="allowDomain" value="*" />\n  </object>\n'),c=function(e){var t=document.createElement("div");return t.innerHTML=s,t.id="cytron-mqtt-wrapper",e.appendChild(t),document.getElementById("cytron-mqtt-swf")},u=function l(e,t,n){var r=this;o(this,l);var i=c(e),a=null,s=!1;this.subscribe=function(e){i.subscribe(e)},this.connect=function(o){return clearTimeout(a),a=null,i||(i=c(e)),i.connect?(i.connect({username:o.userName,password:o.password,clientid:n,host:t,port:1883,tname:"videojj"}),window.onMqttConnected=function(){s=!0,o.onSuccess&&o.onSuccess()},window.onMqttMessageArrived=function(e){var t=e.match(/(\w|\/|@)+:/)[0];r.onMessageArrived&&r.onMessageArrived({destinationName:t.substr(0,t.length-1),payloadString:e.replace(t,"").replace("\n","<br>")})},void(window.onMqttConnectionLost=function(e){s=!1,r.onConnectionLost&&r.onConnectionLost(e)})):void(a=setTimeout(function(){return r.connect(o)},300))},this.disconnect=function(){if(clearTimeout(a),s=!1,a=null,delete window.onMqttConnected,delete window.onMqttMessageArrived,delete window.onMqttConnectionLost,i){i.disconnect&&i.disconnect();var e=i.parentElement;e.parentElement.removeChild(e),i=null}},this.isConnected=function(){return!a&&s}};t["default"]=u},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.host;return/^([\w-]+:)?\/\/([^\/]+)/.test(e),RegExp.$2!==t}function o(e){var t=new XMLHttpRequest;if(!r(e)||"withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest){var n=/^https?/;if(window.location.href.match(n)[0]!==e.match(n)[0])throw new Error("XDomainRequest: requests must be targeted to the same scheme as the hosting page.");return new XDomainRequest}throw new Error("Browser does not support cross-origin requests")}function i(e){return"string"==typeof e?e:Object.keys(e).reduce(function(t,n){var r=null===e[n]?"":e[n];return void 0!==r&&(t+=""+(t&&"&")+encodeURIComponent(n)+"="+encodeURIComponent(r)),t},"")}function a(e,t){return t=i(t||""),t?(e+"&"+t).replace(/[&?]{1,2}/,"?"):e}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new v.Promise(function(n,i){var s=["GET","POST","PUT","PATCH","DELETE"],c=(t.method||"GET").toUpperCase();if(s.indexOf(c)===-1)throw new Error("Invalid options.method "+c);var u=a(e,t.query),l=t.body||"",f=y({Accept:"application/json, text/plain, */*","Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XHRHttpRequest"},t.headers);r(e)&&delete f["X-Requested-With"];var d=o(e);d.open(c,u,!0),d.onload=function(){var r="status"in d,o=!r||d.status>=200&&d.status<300,a={request:y({url:e},t),status:d.status,statusText:d.statusText};try{a.data=JSON.parse(d.responseText)}catch(s){a.data=d.responseText}o?n(a):i(a)},d.ontimeout=d.onerror=i,d.timeout=t.timeout||0,Object.keys(f).forEach(function(e){d.setRequestHeader(e,f[e])});var p="object"===("undefined"==typeof l?"undefined":h(l))?JSON.stringify(l):l;return d.send(p)})}function c(e,t,n){return s(e,y({method:"GET",query:t},n))}function u(e,t,n){return s(e,y({method:"POST",body:t},n))}function l(e,t,n){return s(e,y({method:"PUT",body:t},n))}function f(e,t,n){return s(e,y({method:"PATCH",body:t},n))}function d(e,t,n){return s(e,y({method:"DELETE",body:t},n))}function p(e,t){var n="cytronJsonpHandle_"+Date.now(),r=a(e,y({callback:n},t)),o=void 0;return window[n]=function(e){o=e},(0,m.$script)(r).then(function(){return delete window[n],{data:o,request:{url:e,query:t}}})}Object.defineProperty(t,"__esModule",{value:!0});var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.isCrossDomain=r,t.mkRequest=o,t.toQueryString=i,t.appendQuery=a,t.$ajax=s,t.$get=c,t.$post=u,t.$put=l,t.$patch=f,t.$delete=d,t.$jsonp=p;var v=n(96),m=n(97);n(5)("cy:request")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=window.Paho;"undefined"==typeof r&&(r={}),r.MQTT=function(e){function t(e,t){var n=t,o=e[t],i=o>>4,s=o&=15;t+=1;var c,u=0,f=1;do{if(t==e.length)return[null,n];c=e[t++],u+=(127&c)*f,f*=128}while(0!=(128&c));var p=t+u;if(p>e.length)return[null,n];var h=new _(i);switch(i){case d.CONNACK:var y=e[t++];1&y&&(h.sessionPresent=!0),h.returnCode=e[t++];break;case d.PUBLISH:var v=s>>1&3,m=a(e,t);t+=2;var g=l(e,t,m);t+=m,v>0&&(h.messageIdentifier=a(e,t),t+=2);var b=new r.MQTT.Message(e.subarray(t,p));1==(1&s)&&(b.retained=!0),8==(8&s)&&(b.duplicate=!0),b.qos=v,b.destinationName=g,h.payloadMessage=b;break;case d.PUBACK:case d.PUBREC:case d.PUBREL:case d.PUBCOMP:case d.UNSUBACK:h.messageIdentifier=a(e,t);break;case d.SUBACK:h.messageIdentifier=a(e,t),t+=2,h.returnCode=e.subarray(t,p)}return[h,p]}function o(e,t,n){return t[n++]=e>>8,t[n++]=e%256,n}function i(e,t,n,r){return r=o(t,n,r),u(e,n,r),r+t}function a(e,t){return 256*e[t]+e[t+1]}function s(e){var t=new Array(1),n=0;do{var r=e%128;e>>=7,e>0&&(r|=128),t[n++]=r}while(e>0&&n<4);return t}function c(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r>2047?(55296<=r&&r<=56319&&(n++,t++),t+=3):r>127?t+=2:t++}return t}function u(e,t,n){for(var r=n,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(55296<=i&&i<=56319){var a=e.charCodeAt(++o);if(isNaN(a))throw new Error(m(y.MALFORMED_UNICODE,[i,a]));i=(i-55296<<10)+(a-56320)+65536}i<=127?t[r++]=i:i<=2047?(t[r++]=i>>6&31|192,t[r++]=63&i|128):i<=65535?(t[r++]=i>>12&15|224,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>18&7|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t}function l(e,t,n){for(var r,o="",i=t;i<t+n;){var a=e[i++];if(a<128)r=a;else{var s=e[i++]-128;if(s<0)throw new Error(m(y.MALFORMED_UTF,[a.toString(16),s.toString(16),""]));if(a<224)r=64*(a-192)+s;else{var c=e[i++]-128;if(c<0)throw new Error(m(y.MALFORMED_UTF,[a.toString(16),s.toString(16),c.toString(16)]));if(a<240)r=4096*(a-224)+64*s+c;else{var u=e[i++]-128;if(u<0)throw new Error(m(y.MALFORMED_UTF,[a.toString(16),s.toString(16),c.toString(16),u.toString(16)]));if(!(a<248))throw new Error(m(y.MALFORMED_UTF,[a.toString(16),s.toString(16),c.toString(16),u.toString(16)]));r=262144*(a-240)+4096*s+64*c+u}}}r>65535&&(r-=65536,o+=String.fromCharCode(55296+(r>>10)),r=56320+(1023&r)),o+=String.fromCharCode(r)}return o}var f="@VERSION@",d={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},p=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){if(!t.hasOwnProperty(r)){var o="Unknown property, "+r+". Valid properties are:";for(var r in t)t.hasOwnProperty(r)&&(o=o+" "+r);throw new Error(o)}if(n(e[r])!==t[r])throw new Error(m(y.INVALID_TYPE,[n(e[r]),r]))}},h=function(e,t){return function(){return e.apply(t,arguments)}},y={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."}},v={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},m=function(e,t){var n=e.text;if(t)for(var r,o,i=0;i<t.length;i++)if(r="{"+i+"}",o=n.indexOf(r),o>0){var a=n.substring(0,o),s=n.substring(o+r.length);n=a+t[i]+s}return n},g=[0,6,77,81,73,115,100,112,3],b=[0,4,77,81,84,84,4],_=function(e,t){this.type=e;for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])};_.prototype.encode=function(){var e=(15&this.type)<<4,t=0,n=new Array,r=0;switch(void 0!=this.messageIdentifier&&(t+=2),this.type){case d.CONNECT:switch(this.mqttVersion){case 3:t+=g.length+3;break;case 4:t+=b.length+3}if(t+=c(this.clientId)+2,void 0!=this.willMessage){t+=c(this.willMessage.destinationName)+2;var a=this.willMessage.payloadBytes;
a instanceof Uint8Array||(a=new Uint8Array(l)),t+=a.byteLength+2}void 0!=this.userName&&(t+=c(this.userName)+2),void 0!=this.password&&(t+=c(this.password)+2);break;case d.SUBSCRIBE:e|=2;for(var u=0;u<this.topics.length;u++)n[u]=c(this.topics[u]),t+=n[u]+2;t+=this.requestedQos.length;break;case d.UNSUBSCRIBE:e|=2;for(var u=0;u<this.topics.length;u++)n[u]=c(this.topics[u]),t+=n[u]+2;break;case d.PUBREL:e|=2;break;case d.PUBLISH:this.payloadMessage.duplicate&&(e|=8),e=e|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(e|=1),r=c(this.payloadMessage.destinationName),t+=r+2;var l=this.payloadMessage.payloadBytes;t+=l.byteLength,l instanceof ArrayBuffer?l=new Uint8Array(l):l instanceof Uint8Array||(l=new Uint8Array(l.buffer));break;case d.DISCONNECT:}var f=s(t),p=f.length+1,h=new ArrayBuffer(t+p),y=new Uint8Array(h);if(y[0]=e,y.set(f,1),this.type==d.PUBLISH)p=i(this.payloadMessage.destinationName,r,y,p);else if(this.type==d.CONNECT){switch(this.mqttVersion){case 3:y.set(g,p),p+=g.length;break;case 4:y.set(b,p),p+=b.length}var v=0;this.cleanSession&&(v=2),void 0!=this.willMessage&&(v|=4,v|=this.willMessage.qos<<3,this.willMessage.retained&&(v|=32)),void 0!=this.userName&&(v|=128),void 0!=this.password&&(v|=64),y[p++]=v,p=o(this.keepAliveInterval,y,p)}switch(void 0!=this.messageIdentifier&&(p=o(this.messageIdentifier,y,p)),this.type){case d.CONNECT:p=i(this.clientId,c(this.clientId),y,p),void 0!=this.willMessage&&(p=i(this.willMessage.destinationName,c(this.willMessage.destinationName),y,p),p=o(a.byteLength,y,p),y.set(a,p),p+=a.byteLength),void 0!=this.userName&&(p=i(this.userName,c(this.userName),y,p)),void 0!=this.password&&(p=i(this.password,c(this.password),y,p));break;case d.PUBLISH:y.set(l,p);break;case d.SUBSCRIBE:for(var u=0;u<this.topics.length;u++)p=i(this.topics[u],n[u],y,p),y[p++]=this.requestedQos[u];break;case d.UNSUBSCRIBE:for(var u=0;u<this.topics.length;u++)p=i(this.topics[u],n[u],y,p)}return h};var w=function(e,t,n){this._client=e,this._window=t,this._keepAliveInterval=1e3*n,this.isReset=!1;var r=new _(d.PINGREQ).encode(),o=function(e){return function(){return i.apply(e)}},i=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(r),this.timeout=this._window.setTimeout(o(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(y.PING_TIMEOUT.code,m(y.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(o(this),this._keepAliveInterval))},this.cancel=function(){this._window.clearTimeout(this.timeout)}},O=function(e,t,n,r,o){this._window=t,n||(n=30);var i=function(e,t,n){return function(){return e.apply(t,n)}};this.timeout=setTimeout(i(r,e,o),1e3*n),this.cancel=function(){this._window.clearTimeout(this.timeout)}},T=function(t,n,r,o,i){if(!("WebSocket"in e&&null!==e.WebSocket))throw new Error(m(y.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in e&&null!==e.localStorage))throw new Error(m(y.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in e&&null!==e.ArrayBuffer))throw new Error(m(y.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",t,n,r,o,i),this.host=n,this.port=r,this.path=o,this.uri=t,this.clientId=i,this._localKey=n+":"+r+("/mqtt"!=o?":"+o:"")+":"+i+":",this._msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0;for(var a in localStorage)0!=a.indexOf("Sent:"+this._localKey)&&0!=a.indexOf("Received:"+this._localKey)||this.restore(a)};T.prototype.host,T.prototype.port,T.prototype.path,T.prototype.uri,T.prototype.clientId,T.prototype.socket,T.prototype.connected=!1,T.prototype.maxMessageIdentifier=65536,T.prototype.connectOptions,T.prototype.hostIndex,T.prototype.onConnectionLost,T.prototype.onMessageDelivered,T.prototype.onMessageArrived,T.prototype.traceFunction,T.prototype._msg_queue=null,T.prototype._connectTimeout,T.prototype.sendPinger=null,T.prototype.receivePinger=null,T.prototype.receiveBuffer=null,T.prototype._traceBuffer=null,T.prototype._MAX_TRACE_ENTRIES=100,T.prototype.connect=function(e){var t=this._traceMask(e,"password");if(this._trace("Client.connect",t,this.socket,this.connected),this.connected)throw new Error(m(y.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(m(y.INVALID_STATE,["already connected"]));this.connectOptions=e,e.uris?(this.hostIndex=0,this._doConnect(e.uris[0])):this._doConnect(this.uri)},T.prototype.subscribe=function(e,t){if(this._trace("Client.subscribe",e,t),!this.connected)throw new Error(m(y.INVALID_STATE,["not connected"]));var n=new _(d.SUBSCRIBE);n.topics=[e],void 0!=t.qos?n.requestedQos=[t.qos]:n.requestedQos=[0],t.onSuccess&&(n.onSuccess=function(e){t.onSuccess({invocationContext:t.invocationContext,grantedQos:e})}),t.onFailure&&(n.onFailure=function(e){t.onFailure({invocationContext:t.invocationContext,errorCode:e})}),t.timeout&&(n.timeOut=new O(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:y.SUBSCRIBE_TIMEOUT.code,errorMessage:m(y.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},T.prototype.unsubscribe=function(e,t){if(this._trace("Client.unsubscribe",e,t),!this.connected)throw new Error(m(y.INVALID_STATE,["not connected"]));var n=new _(d.UNSUBSCRIBE);n.topics=[e],t.onSuccess&&(n.callback=function(){t.onSuccess({invocationContext:t.invocationContext})}),t.timeout&&(n.timeOut=new O(this,window,t.timeout,t.onFailure,[{invocationContext:t.invocationContext,errorCode:y.UNSUBSCRIBE_TIMEOUT.code,errorMessage:m(y.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(n),this._schedule_message(n)},T.prototype.send=function(e){if(this._trace("Client.send",e),!this.connected)throw new Error(m(y.INVALID_STATE,["not connected"]));var t=new _(d.PUBLISH);t.payloadMessage=e,e.qos>0?this._requires_ack(t):this.onMessageDelivered&&(this._notify_msg_sent[t]=this.onMessageDelivered(t.payloadMessage)),this._schedule_message(t)},T.prototype.disconnect=function(){if(this._trace("Client.disconnect"),!this.socket)throw new Error(m(y.INVALID_STATE,["not connecting or connected"]));var e=new _(d.DISCONNECT);this._notify_msg_sent[e]=h(this._disconnected,this),this._schedule_message(e)},T.prototype.getTraceLog=function(){if(null!==this._traceBuffer){this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var e in this._sentMessages)this._trace("_sentMessages ",e,this._sentMessages[e]);for(var e in this._receivedMessages)this._trace("_receivedMessages ",e,this._receivedMessages[e]);return this._traceBuffer}},T.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,f)},T.prototype.stopTrace=function(){delete this._traceBuffer},T.prototype._doConnect=function(e){if(this.connectOptions.useSSL){var t=e.split(":");t[0]="wss",e=t.join(":")}this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(e,["mqttv3.1"]):this.socket=new WebSocket(e,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=h(this._on_socket_open,this),this.socket.onmessage=h(this._on_socket_message,this),this.socket.onerror=h(this._on_socket_error,this),this.socket.onclose=h(this._on_socket_close,this),this.sendPinger=new w(this,window,this.connectOptions.keepAliveInterval),this.receivePinger=new w(this,window,this.connectOptions.keepAliveInterval),this._connectTimeout=new O(this,window,this.connectOptions.timeout,this._disconnected,[y.CONNECT_TIMEOUT.code,m(y.CONNECT_TIMEOUT)])},T.prototype._schedule_message=function(e){this._msg_queue.push(e),this.connected&&this._process_queue()},T.prototype.store=function(e,t){var n={type:t.type,messageIdentifier:t.messageIdentifier,version:1};switch(t.type){case d.PUBLISH:t.pubRecReceived&&(n.pubRecReceived=!0),n.payloadMessage={};for(var r="",o=t.payloadMessage.payloadBytes,i=0;i<o.length;i++)o[i]<=15?r=r+"0"+o[i].toString(16):r+=o[i].toString(16);n.payloadMessage.payloadHex=r,n.payloadMessage.qos=t.payloadMessage.qos,n.payloadMessage.destinationName=t.payloadMessage.destinationName,t.payloadMessage.duplicate&&(n.payloadMessage.duplicate=!0),t.payloadMessage.retained&&(n.payloadMessage.retained=!0),0==e.indexOf("Sent:")&&(void 0===t.sequence&&(t.sequence=++this._sequence),n.sequence=t.sequence);break;default:throw Error(m(y.INVALID_STORED_DATA,[key,n]))}localStorage.setItem(e+this._localKey+t.messageIdentifier,JSON.stringify(n))},T.prototype.restore=function(e){var t=localStorage.getItem(e),n=JSON.parse(t),o=new _(n.type,n);switch(n.type){case d.PUBLISH:for(var i=n.payloadMessage.payloadHex,a=new ArrayBuffer(i.length/2),s=new Uint8Array(a),c=0;i.length>=2;){var u=parseInt(i.substring(0,2),16);i=i.substring(2,i.length),s[c++]=u}var l=new r.MQTT.Message(s);l.qos=n.payloadMessage.qos,l.destinationName=n.payloadMessage.destinationName,n.payloadMessage.duplicate&&(l.duplicate=!0),n.payloadMessage.retained&&(l.retained=!0),o.payloadMessage=l;break;default:throw Error(m(y.INVALID_STORED_DATA,[e,t]))}0==e.indexOf("Sent:"+this._localKey)?(o.payloadMessage.duplicate=!0,this._sentMessages[o.messageIdentifier]=o):0==e.indexOf("Received:"+this._localKey)&&(this._receivedMessages[o.messageIdentifier]=o)},T.prototype._process_queue=function(){for(var e=null,t=this._msg_queue.reverse();e=t.pop();)this._socket_send(e),this._notify_msg_sent[e]&&(this._notify_msg_sent[e](),delete this._notify_msg_sent[e])},T.prototype._requires_ack=function(e){var t=Object.keys(this._sentMessages).length;if(t>this.maxMessageIdentifier)throw Error("Too many messages:"+t);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;e.messageIdentifier=this._message_identifier,this._sentMessages[e.messageIdentifier]=e,e.type===d.PUBLISH&&this.store("Sent:",e),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},T.prototype._on_socket_open=function(){var e=new _(d.CONNECT,this.connectOptions);e.clientId=this.clientId,this._socket_send(e)},T.prototype._on_socket_message=function(e){this._trace("Client._on_socket_message",e.data);for(var t=this._deframeMessages(e.data),n=0;n<t.length;n+=1)this._handleMessage(t[n])},T.prototype._deframeMessages=function(e){var n=new Uint8Array(e);if(this.receiveBuffer){var r=new Uint8Array(this.receiveBuffer.length+n.length);r.set(this.receiveBuffer),r.set(n,this.receiveBuffer.length),n=r,delete this.receiveBuffer}try{for(var o=0,i=[];o<n.length;){var a=t(n,o),s=a[0];if(o=a[1],null===s)break;i.push(s)}o<n.length&&(this.receiveBuffer=n.subarray(o))}catch(c){return void this._disconnected(y.INTERNAL_ERROR.code,m(y.INTERNAL_ERROR,[c.message,c.stack.toString()]))}return i},T.prototype._handleMessage=function(e){this._trace("Client._handleMessage",e);try{switch(e.type){case d.CONNACK:if(this._connectTimeout.cancel(),this.connectOptions.cleanSession){for(var t in this._sentMessages){var n=this._sentMessages[t];localStorage.removeItem("Sent:"+this._localKey+n.messageIdentifier)}this._sentMessages={};for(var t in this._receivedMessages){var r=this._receivedMessages[t];localStorage.removeItem("Received:"+this._localKey+r.messageIdentifier)}this._receivedMessages={}}if(0!==e.returnCode){this._disconnected(y.CONNACK_RETURNCODE.code,m(y.CONNACK_RETURNCODE,[e.returnCode,v[e.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);var o=new Array;for(var i in this._sentMessages)this._sentMessages.hasOwnProperty(i)&&o.push(this._sentMessages[i]);for(var o=o.sort(function(e,t){return e.sequence-t.sequence}),a=0,s=o.length;a<s;a++){var n=o[a];if(n.type==d.PUBLISH&&n.pubRecReceived){var c=new _(d.PUBREL,{messageIdentifier:n.messageIdentifier});this._schedule_message(c)}else this._schedule_message(n)}this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext}),this._process_queue();break;case d.PUBLISH:this._receivePublish(e);break;case d.PUBACK:var n=this._sentMessages[e.messageIdentifier];n&&(delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(n.payloadMessage));break;case d.PUBREC:var n=this._sentMessages[e.messageIdentifier];if(n){n.pubRecReceived=!0;var c=new _(d.PUBREL,{messageIdentifier:e.messageIdentifier});this.store("Sent:",n),this._schedule_message(c)}break;case d.PUBREL:var r=this._receivedMessages[e.messageIdentifier];localStorage.removeItem("Received:"+this._localKey+e.messageIdentifier),r&&(this._receiveMessage(r),delete this._receivedMessages[e.messageIdentifier]);var u=new _(d.PUBCOMP,{messageIdentifier:e.messageIdentifier});this._schedule_message(u);break;case d.PUBCOMP:var n=this._sentMessages[e.messageIdentifier];delete this._sentMessages[e.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+e.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(n.payloadMessage);break;case d.SUBACK:var n=this._sentMessages[e.messageIdentifier];n&&(n.timeOut&&n.timeOut.cancel(),e.returnCode.indexOf=Array.prototype.indexOf,e.returnCode.indexOf(128)!==-1?n.onFailure&&n.onFailure(e.returnCode):n.onSuccess&&n.onSuccess(e.returnCode),delete this._sentMessages[e.messageIdentifier]);break;case d.UNSUBACK:var n=this._sentMessages[e.messageIdentifier];n&&(n.timeOut&&n.timeOut.cancel(),n.callback&&n.callback(),delete this._sentMessages[e.messageIdentifier]);break;case d.PINGRESP:this.sendPinger.reset();break;case d.DISCONNECT:this._disconnected(y.INVALID_MQTT_MESSAGE_TYPE.code,m(y.INVALID_MQTT_MESSAGE_TYPE,[e.type]));break;default:this._disconnected(y.INVALID_MQTT_MESSAGE_TYPE.code,m(y.INVALID_MQTT_MESSAGE_TYPE,[e.type]))}}catch(l){return void this._disconnected(y.INTERNAL_ERROR.code,m(y.INTERNAL_ERROR,[l.message,l.stack.toString()]))}},T.prototype._on_socket_error=function(e){this._disconnected(y.SOCKET_ERROR.code,m(y.SOCKET_ERROR,[e.data]))},T.prototype._on_socket_close=function(){this._disconnected(y.SOCKET_CLOSE.code,m(y.SOCKET_CLOSE))},T.prototype._socket_send=function(e){if(1==e.type){var t=this._traceMask(e,"password");this._trace("Client._socket_send",t)}else this._trace("Client._socket_send",e);this.socket.send(e.encode()),this.sendPinger.reset()},T.prototype._receivePublish=function(e){switch(e.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(e);break;case 1:var t=new _(d.PUBACK,{messageIdentifier:e.messageIdentifier});this._schedule_message(t),this._receiveMessage(e);break;case 2:this._receivedMessages[e.messageIdentifier]=e,this.store("Received:",e);var n=new _(d.PUBREC,{messageIdentifier:e.messageIdentifier});this._schedule_message(n);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}},T.prototype._receiveMessage=function(e){this.onMessageArrived&&this.onMessageArrived(e.payloadMessage)},T.prototype._disconnected=function(e,t){this._trace("Client._disconnected",e,t),this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&this._connectTimeout.cancel(),this._msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1?(this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex])):(void 0===e&&(e=y.OK.code,t=m(y.OK)),this.connected?(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:e,errorMessage:t})):4===this.connectOptions.mqttVersion&&this.connectOptions.mqttVersionExplicit===!1?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:e,errorMessage:t}))},T.prototype._trace=function(){if(this.traceFunction){for(var e in arguments)"undefined"!=typeof arguments[e]&&(arguments[e]=JSON.stringify(arguments[e]));var t=Array.prototype.slice.call(arguments).join("");this.traceFunction({severity:"Debug",message:t})}if(null!==this._traceBuffer)for(var e=0,n=arguments.length;e<n;e++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===e?this._traceBuffer.push(arguments[e]):"undefined"==typeof arguments[e]?this._traceBuffer.push(arguments[e]):this._traceBuffer.push("  "+JSON.stringify(arguments[e]))},T.prototype._traceMask=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(r==t?n[r]="******":n[r]=e[r]);return n};var k=function(e,t,r,o){var i;if("string"!=typeof e)throw new Error(m(y.INVALID_TYPE,["undefined"==typeof e?"undefined":n(e),"host"]));if(2==arguments.length){o=t,i=e;var a=i.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!a)throw new Error(m(y.INVALID_ARGUMENT,[e,"host"]));e=a[4]||a[2],t=parseInt(a[7]),r=a[8]}else{if(3==arguments.length&&(o=r,r="/mqtt"),"number"!=typeof t||t<0)throw new Error(m(y.INVALID_TYPE,["undefined"==typeof t?"undefined":n(t),"port"]));if("string"!=typeof r)throw new Error(m(y.INVALID_TYPE,["undefined"==typeof r?"undefined":n(r),"path"]));var s=e.indexOf(":")!=-1&&"["!=e.slice(0,1)&&"]"!=e.slice(-1);i="ws://"+(s?"["+e+"]":e)+":"+t+r}for(var c=0,u=0;u<o.length;u++){var l=o.charCodeAt(u);55296<=l&&l<=56319&&u++,c++}if("string"!=typeof o||c>65535)throw new Error(m(y.INVALID_ARGUMENT,[o,"clientId"]));var f=new T(i,e,t,r,o);this._getHost=function(){return e},this._setHost=function(){throw new Error(m(y.UNSUPPORTED_OPERATION))},this._getPort=function(){return t},this._setPort=function(){throw new Error(m(y.UNSUPPORTED_OPERATION))},this._getPath=function(){return r},this._setPath=function(){throw new Error(m(y.UNSUPPORTED_OPERATION))},this._getURI=function(){return i},this._setURI=function(){throw new Error(m(y.UNSUPPORTED_OPERATION))},this._getClientId=function(){return f.clientId},this._setClientId=function(){throw new Error(m(y.UNSUPPORTED_OPERATION))},this._getOnConnectionLost=function(){return f.onConnectionLost},this._setOnConnectionLost=function(e){if("function"!=typeof e)throw new Error(m(y.INVALID_TYPE,["undefined"==typeof e?"undefined":n(e),"onConnectionLost"]));f.onConnectionLost=e},this._getOnMessageDelivered=function(){return f.onMessageDelivered},this._setOnMessageDelivered=function(e){if("function"!=typeof e)throw new Error(m(y.INVALID_TYPE,["undefined"==typeof e?"undefined":n(e),"onMessageDelivered"]));f.onMessageDelivered=e},this._getOnMessageArrived=function(){return f.onMessageArrived},this._setOnMessageArrived=function(e){if("function"!=typeof e)throw new Error(m(y.INVALID_TYPE,["undefined"==typeof e?"undefined":n(e),"onMessageArrived"]));f.onMessageArrived=e},this._getTrace=function(){return f.traceFunction},this._setTrace=function(e){if("function"!=typeof e)throw new Error(m(y.INVALID_TYPE,["undefined"==typeof e?"undefined":n(e),"onTrace"]));f.traceFunction=e},this.connect=function(e){if(e=e||{},p(e,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===e.keepAliveInterval&&(e.keepAliveInterval=60),e.mqttVersion>4||e.mqttVersion<3)throw new Error(m(y.INVALID_ARGUMENT,[e.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===e.mqttVersion?(e.mqttVersionExplicit=!1,e.mqttVersion=4):e.mqttVersionExplicit=!0,void 0===e.password&&void 0!==e.userName)throw new Error(m(y.INVALID_ARGUMENT,[e.password,"connectOptions.password"]));if(e.willMessage){if(!(e.willMessage instanceof I))throw new Error(m(y.INVALID_TYPE,[e.willMessage,"connectOptions.willMessage"]));if(e.willMessage.stringPayload,"undefined"==typeof e.willMessage.destinationName)throw new Error(m(y.INVALID_TYPE,[n(e.willMessage.destinationName),"connectOptions.willMessage.destinationName"]))}if("undefined"==typeof e.cleanSession&&(e.cleanSession=!0),e.hosts){if(!(e.hosts instanceof Array))throw new Error(m(y.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));if(e.hosts.length<1)throw new Error(m(y.INVALID_ARGUMENT,[e.hosts,"connectOptions.hosts"]));for(var t=!1,o=0;o<e.hosts.length;o++){if("string"!=typeof e.hosts[o])throw new Error(m(y.INVALID_TYPE,[n(e.hosts[o]),"connectOptions.hosts["+o+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(e.hosts[o])){if(0==o)t=!0;else if(!t)throw new Error(m(y.INVALID_ARGUMENT,[e.hosts[o],"connectOptions.hosts["+o+"]"]))}else if(t)throw new Error(m(y.INVALID_ARGUMENT,[e.hosts[o],"connectOptions.hosts["+o+"]"]))}if(t)e.uris=e.hosts;else{if(!e.ports)throw new Error(m(y.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(!(e.ports instanceof Array))throw new Error(m(y.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));if(e.hosts.length!=e.ports.length)throw new Error(m(y.INVALID_ARGUMENT,[e.ports,"connectOptions.ports"]));e.uris=[];for(var o=0;o<e.hosts.length;o++){if("number"!=typeof e.ports[o]||e.ports[o]<0)throw new Error(m(y.INVALID_TYPE,[n(e.ports[o]),"connectOptions.ports["+o+"]"]));var a=e.hosts[o],s=e.ports[o],c=a.indexOf(":")!=-1;i="ws://"+(c?"["+a+"]":a)+":"+s+r,e.uris.push(i)}}}f.connect(e)},this.subscribe=function(e,t){if("string"!=typeof e)throw new Error("Invalid argument:"+e);if(t=t||{},p(t,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!=typeof t.qos&&0!==t.qos&&1!==t.qos&&2!==t.qos)throw new Error(m(y.INVALID_ARGUMENT,[t.qos,"subscribeOptions.qos"]));f.subscribe(e,t)},this.unsubscribe=function(e,t){if("string"!=typeof e)throw new Error("Invalid argument:"+e);if(t=t||{},p(t,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),t.timeout&&!t.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");f.unsubscribe(e,t)},this.send=function(e,t,r,o){var i;if(0==arguments.length)throw new Error("Invalid argument.length");if(1==arguments.length){if(!(e instanceof I)&&"string"!=typeof e)throw new Error("Invalid argument:"+("undefined"==typeof e?"undefined":n(e)));if(i=e,"undefined"==typeof i.destinationName)throw new Error(m(y.INVALID_ARGUMENT,[i.destinationName,"Message.destinationName"]));f.send(i)}else i=new I(t),i.destinationName=e,arguments.length>=3&&(i.qos=r),arguments.length>=4&&(i.retained=o),f.send(i)},this.disconnect=function(){f.disconnect()},this.getTraceLog=function(){return f.getTraceLog()},this.startTrace=function(){f.startTrace()},this.stopTrace=function(){f.stopTrace()},this.isConnected=function(){return f.connected}};k.prototype={get host(){return this._getHost()},set host(e){this._setHost(e)},get port(){return this._getPort()},set port(e){this._setPort(e)},get path(){return this._getPath()},set path(e){this._setPath(e)},get clientId(){return this._getClientId()},set clientId(e){this._setClientId(e)},get onConnectionLost(){return this._getOnConnectionLost()},set onConnectionLost(e){this._setOnConnectionLost(e)},get onMessageDelivered(){return this._getOnMessageDelivered()},set onMessageDelivered(e){this._setOnMessageDelivered(e)},get onMessageArrived(){return this._getOnMessageArrived()},set onMessageArrived(e){this._setOnMessageArrived(e)},get trace(){return this._getTrace()},set trace(e){this._setTrace(e)}};var I=function(e){var t;if(!("string"==typeof e||e instanceof ArrayBuffer||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array))throw m(y.INVALID_ARGUMENT,[e,"newPayload"]);t=e,this._getPayloadString=function(){return"string"==typeof t?t:l(t,0,t.length)},this._getPayloadBytes=function(){if("string"==typeof t){var e=new ArrayBuffer(c(t)),n=new Uint8Array(e);return u(t,n,0),n}return t};var n=void 0;this._getDestinationName=function(){return n},this._setDestinationName=function(e){if("string"!=typeof e)throw new Error(m(y.INVALID_ARGUMENT,[e,"newDestinationName"]));n=e};var r=0;this._getQos=function(){return r},this._setQos=function(e){if(0!==e&&1!==e&&2!==e)throw new Error("Invalid argument:"+e);r=e};var o=!1;this._getRetained=function(){return o},this._setRetained=function(e){if("boolean"!=typeof e)throw new Error(m(y.INVALID_ARGUMENT,[e,"newRetained"]));o=e};var i=!1;this._getDuplicate=function(){return i},this._setDuplicate=function(e){i=e}};return I.prototype={get payloadString(){return this._getPayloadString()},get payloadBytes(){return this._getPayloadBytes()},get destinationName(){return this._getDestinationName()},set destinationName(e){this._setDestinationName(e)},get qos(){return this._getQos()},set qos(e){this._setQos(e)},get retained(){return this._getRetained()},set retained(e){this._setRetained(e)},get duplicate(){return this._getDuplicate()},set duplicate(e){this._setDuplicate(e)}},{Client:k,Message:I}}(window),e.exports=r}]);